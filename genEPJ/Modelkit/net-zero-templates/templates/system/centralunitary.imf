<%#INITIALIZE
parameter "system_name"
parameter "zone_names"

parameter "control_zone_name"

parameter "return_plenum_zone_name", :default=>nil
parameter "use_dummy_return_plenum", :default=>false

parameter "oa_economizer", :default=>true
parameter "oa_econ_high_limit", :default=>75|'F'   # Maximum outdoor air temperature for economizer operation (depends on climate zone for ASHRAE 90.1)

# NEEDS WORK BEFORE USING--CANNOT AUTOSIZE
parameter "oa_desiccant_hx", :default=>false  # Turns on/off desiccant dehumidifier
parameter "oa_desicc_fan_eff", :default=>0.6  # Regeneration fan total efficiency
parameter "oa_desicc_fan_rise", :default=>0.25|'in H2O'  # Regeneration fan pressure rise

parameter "oa_energy_recovery", :default=>false
parameter "oa_er_sensible_eff", :default=>0.7
parameter "oa_er_latent_eff", :default=>0.7

parameter "oa_indirect_evap", :default=>false
parameter "oa_ind_evap_eff", :default=>1.0
parameter "oa_ind_evap_wb_eff", :default=>1.0 # Evap cooler wetbulb design effectiveness
parameter "oa_ind_evap_db_eff", :default=>1.0 # Evap cooler drybulb design effectiveness
parameter "oa_ind_evap_pump_factor", :default=>90 # W/(m3/s), used to autosize recirculating water pump
parameter "oa_ind_evap_fan_factor", :default=>250 # W/(m3/s), used to autosize secondary air fan
parameter "oa_ind_evap_secondary", :default=>"RETURN"

parameter "night_cycle", :default=>false

parameter "cooling_coil_type", :default=>"DX"    # ( DX | ASHP | WSHP | NONE )
parameter "cooling_coil_cop", :default=>3.23     # first-stage cooling cop
parameter "cooling_coil_cop_2", :default=>0.0     # second-stage cooling cop
parameter "cooling_coil_cop_3", :default=>0.0     # third-stage cooling cop
parameter "cooling_coil_cop_4", :default=>0.0     # fourth-stage cooling cop
parameter "cooling_coil_cd", :default=>0.07     # used in PLR curve (0.07 for single spd, 0.11 for two spd, 0.25 for four spd)
parameter "cooling_coil_cap", :default=>"Autosize"

parameter "heating_coil_type", :default=>"GAS"    # ( GAS | ELECTRIC | ASHP | WSHP | NONE )
parameter "heating_coil_eff", :default=>0.8    # first-stage heating effectiveness
parameter "heating_coil_eff_2", :default=>0.0    # second-stage heating effectiveness
parameter "heating_coil_eff_3", :default=>0.0    # third-stage heating effectiveness
parameter "heating_coil_eff_4", :default=>0.0    # fourth-stage heating effectiveness
parameter "heating_coil_cd", :default=>0.11     # used in PLR curve (0.11 for single spd, 0.11 for two spd, 0.24 for four spd)
parameter "heating_coil_cap", :default=>"Autosize"

parameter "ashp_type", :default=>"UNITARY"  # ( UNITARY | MINISPLIT ) used to set performance curves

parameter "hp_supp_heat_coil_type", :default=>"ELECTRIC"  # ( NONE | GAS | ELECTRIC ) used with ashp
parameter "hp_supp_heat_coil_eff", :default=>1.0  # used with ashp
parameter "hp_supp_heat_max_temp", :default=>50|'F'    # used with ashp

parameter "hp_supply_max_temp", :default=>105|'F'    # used with ashp
parameter "hp_min_temp", :default=>0|'F'    # used with ashp
parameter "hp_defrost_temp", :default=>40|'F'    # used with ashp


parameter "crankcase_max_temp", :default=>50|'F'
parameter "crankcase_cap", :default=>50|'W'

parameter "sat_low_temp", :default=>55|'F'
parameter "sat_high_temp", :default=>120|'F'


parameter "fan_eff_supply", :default=>0.65
parameter "fan_rise_supply", :default=>1.0|'in H2O'
parameter "fan_flow_supply", :default=>"Autosize"

parameter "operation_schedule", :default=>
"
  Through: 12/31,          !- Field 1
  For: AllDays,            !- Field 2
  Until: 24:00, 1.0;       !- Field 3
"

parameter "clear_water_storage_tank", :default=>"" # variable used to create tank to store clear water as cooling coil condensate
parameter "clear_water_supply_tank", :default=>"" # variable used to create tank to supply clear water for evaporative cooling

%>

<%
if (use_dummy_return_plenum)
  return_plenum_zone_name = system_name + " Dummy Return Plenum"
end

if (cooling_coil_cop_4 > 0 )
  comp_speeds = 4
elsif (cooling_coil_cop_3 > 0 )
  comp_speeds = 3
elsif (cooling_coil_cop_2 > 0 )
  comp_speeds = 2
else
  comp_speeds = 1
end
%>

AirLoopHVAC,
  <%= system_name %>,      !- Name
  ,                        !- Controller List Name
  <%= system_name %> Availability Manager List,  !- Availability Manager List Name
  Autosize,                !- Design Supply Air Flow Rate {m3/s}
  <%= system_name %> Branch List,  !- Branch List Name
  ,                        !- Connector List Name
  <%= system_name %> Supply Equipment Inlet Node,  !- Supply Side Inlet Node Name
  <%= system_name %> Zone Equipment Outlet Node,  !- Demand Side Outlet Node Name
  <%= system_name %> Zone Equipment Inlet Node,  !- Demand Side Inlet Node Names
  <%= system_name %> Supply Equipment Outlet Node;  !- Supply Side Outlet Node Names

Sizing:System,
  <%= system_name %>,      !- AirLoop Name
  Sensible,                !- Type of Load to Size On
  Autosize,                !- Design Outdoor Air Flow Rate {m3/s}
  1.0,                     !- Central Heating Maximum System Air Flow Ratio
  7.0,                     !- Preheat Design Temperature {C}
  0.008,                   !- Preheat Design Humidity Ratio {kg-H2O/kg-Air}
  11.0,                    !- Precool Design Temperature {C}
  0.008,                   !- Precool Design Humidity Ratio {kg-H2O/kg-Air}
  <%= sat_low_temp %>,     !- Central Cooling Design Supply Air Temperature {C}
  <%= sat_high_temp %>,    !- Central Heating Design Supply Air Temperature {C}
  Coincident,              !- Type of Zone Sum to Use
  No,                      !- 100% Outdoor Air in Cooling
  No,                      !- 100% Outdoor Air in Heating
  0.0085,                  !- Central Cooling Design Supply Air Humidity Ratio {kg-H2O/kg-Air}
  0.008,                   !- Central Heating Design Supply Air Humidity Ratio {kg-H2O/kg-Air}
  DesignDay,               !- Cooling Supply Air Flow Rate Method
  ,                        !- Cooling Supply Air Flow Rate {m3/s}
  ,                        !- Cooling Supply Air Flow Rate Per Floor Area {m3/s-m2}
  ,                        !- Cooling Fraction of Autosized Cooling Supply Air Flow Rate
  ,                        !- Cooling Supply Air Flow Rate Per Unit Cooling Capacity {m3/s-W}
  DesignDay,               !- Heating Supply Air Flow Rate Method
  ,                        !- Heating Supply Air Flow Rate {m3/s}
  ,                        !- Heating Supply Air Flow Rate Per Floor Area {m3/s-m2}
  ,                        !- Heating Fraction of Autosized Heating Supply Air Flow Rate
  ,                        !- Heating Fraction of Autosized Cooling Supply Air Flow Rate
  ,                        !- Heating Supply Air Flow Rate Per Unit Heating Capacity {m3/s-W}
  ,                        !- System Outdoor Air Method
  1.0,                     !- Zone Maximum Outdoor Air Fraction {dimensionless}
  CoolingDesignCapacity,   !- Cooling Design Capacity Method
  Autosize,                !- Cooling Design Capacity {W}
  ,                        !- Cooling Design Capacity Per Floor Area {W/m2}
  ,                        !- Fraction of Autosized Cooling Design Capacity
  HeatingDesignCapacity,   !- Heating Design Capacity Method
  Autosize,                !- Heating Design Capacity {W}
  ,                        !- Heating Design Capacity Per Floor Area {W/m2}
  ,                        !- Fraction of Autosized Heating Design Capacity
  OnOff;                   !- Central Cooling Capacity Control Method

Schedule:Constant,
  <%= system_name %> Always On Schedule,          !- Name
  Any Number,                                     !- Schedule Type Limits Name
  1;                                              !- Hourly Value

Schedule:Constant,
  <%= system_name %> Always Off Schedule,          !- Name
  Any Number,                                     !- Schedule Type Limits Name
  0;                                              !- Hourly Value

Schedule:Compact,
  <%= system_name %> Operation Schedule,          !- Name
  Any Number,                                     !- Schedule Type Limits Name
<%= operation_schedule %>

<%# Must be separate from Operation Schedule; Operation Schedule is forced on by night cycle. %>
Schedule:Compact,
  <%= system_name %> Outdoor Air Schedule,  !- Name
  On/Off,                  !- Schedule Type Limits Name
<%= operation_schedule %>

<% if (night_cycle) %>
  AvailabilityManagerAssignmentList,
    <%= system_name %> Availability Manager List,  !- Name
    AvailabilityManager:NightCycle,  !- Availability Manager 1 Object Type
    <%= system_name %> Availability Manager;  !- Availability Manager 1 Name

<%# NOTE:  NightCycle does not affect ALL objects that reference the specified Fan Schedule Name; it only influences
the fan objects connected to this air system with that schedule.
NOTE2:  NightCycle also activates the outdoor air system when the fans turn on.  If outdoor air should be off
for night cycling, specify a different schedule for Minimum Outdoor Air Schedule Name on Controller:OutdoorAir.
*DOAS NOTE:  DOAS should only cycle the zone fan coil units...but unfortunately this doesn't work.
%>
AvailabilityManager:NightCycle,
  <%= system_name %> Availability Manager,  !- Name
  <%= system_name %> Always On Schedule,  !- Applicability Schedule Name
  <%= system_name %> Operation Schedule,  !- Fan Schedule Name
  CycleOnAny,              !- Control Type
  1.0,                     !- Thermostat Tolerance {deltaC}
  FixedRunTime,            !- Cycling Run Time Control Type
  1800;                    !- Cycling Run Time {s}
<% else %>
AvailabilityManagerAssignmentList,
  <%= system_name %> Availability Manager List,  !- Name
  AvailabilityManager:Scheduled,  !- Availability Manager 1 Object Type
  <%= system_name %> Availability Manager;  !- Availability Manager 1 Name

<%# NOTE: Operation Schedule is the only thing that seems to be able to turn off the fans during unoccupied hours. %>
AvailabilityManager:Scheduled,
  <%= system_name %> Availability Manager,  !- Name
  <%= system_name %> Operation Schedule;  !- Schedule Name
<% end %>

BranchList,
  <%= system_name %> Branch List,  !- Name
  <%= system_name %> Main Branch;  !- Branch 1 Name

Branch,
  <%= system_name %> Main Branch,  !- Name
  ,                        !- Pressure Drop Curve Name
  AirLoopHVAC:OutdoorAirSystem,  !- Component 1 Object Type
  <%= system_name %> OA System,    !- Component 1 Name
  <%= system_name %> Supply Equipment Inlet Node,  !- Component 1 Inlet Node Name
  <%= system_name %> OA Outlet Node,  !- Component 1 Outlet Node Name
<% if (cooling_coil_type == "DX" and comp_speeds == 1) %>
  AirLoopHVAC:UnitaryHeatCool,  !- Component 1 Object Type
<% elsif ((heating_coil_type == "GAS" || heating_coil_type == "ELECTRIC") && (cooling_coil_type == "NONE")) %>
  AirLoopHVAC:UnitaryHeatOnly,  !- Component 1 Object Type
<% elsif (heating_coil_type == "ASHP" and cooling_coil_type == "ASHP" and comp_speeds == 1) %>
  AirLoopHVAC:UnitaryHeatPump:AirToAir,  !- Component 1 Object Type
<% elsif (((heating_coil_type == "ASHP" and cooling_coil_type == "ASHP") or cooling_coil_type == "DX") and comp_speeds > 1) %>
  AirLoopHVAC:UnitaryHeatPump:AirToAir:MultiSpeed,  !- Component 1 Object Type
<% elsif (heating_coil_type == "WSHP" and cooling_coil_type == "WSHP") %>
  AirLoopHVAC:UnitaryHeatPump:WaterToAir,  !- Component 1 Object Type
<% end %>
  <%= system_name %> Unitary,   !- Component 1 Name
  <%= system_name %> OA Outlet Node,  !- Component 1 Inlet Node Name
  <%= system_name %> Supply Equipment Outlet Node;  !- Component 1 Outlet Node Name

AirLoopHVAC:OutdoorAirSystem,
  <%= system_name %> OA System,  !- Name
  <%= system_name %> OA Controllers,  !- Controller List Name
  <%= system_name %> OA Equipment,  !- Outdoor Air Equipment List Name
  <%= system_name %> Availability Manager List;  !- Availability Manager List Name

AirLoopHVAC:ControllerList,
  <%= system_name %> OA Controllers,  !- Name
  Controller:OutdoorAir,   !- Controller 1 Object Type
  <%= system_name %> OA Controller;  !- Controller 1 Name

AirLoopHVAC:OutdoorAirSystem:EquipmentList,
  <%= system_name %> OA Equipment,  !- Name
<% if (oa_desiccant_hx) %>
  Dehumidifier:Desiccant:NoFans,  !- Component Object Type
  <%= system_name %> Desiccant Dehumidifier,  !- Component Name
<% end %>
<% if (oa_energy_recovery) %>
  HeatExchanger:AirToAir:SensibleAndLatent,  !- Component Object Type
  <%= system_name %> Energy Recovery Wheel,  !- Component Name
<% end %>
<% if (oa_indirect_evap) %>
  EvaporativeCooler:Indirect:ResearchSpecial,  !- Component Object Type
  <%= system_name %> Indirect Evap Cooler,  !- Component Name
<% end %>
  OutdoorAir:Mixer,        !- Component Object Type
  <%= system_name %> OA Mixer;     !- Component Name

OutdoorAir:Node,
  <%= system_name %> Outside Air Inlet Node;  !- Name

<% if (oa_desiccant_hx) %>
<%# NEEDS WORK BEFORE USING--CANNOT AUTOSIZE %>
Dehumidifier:Desiccant:NoFans,
  <%= system_name %> Desiccant Dehumidifier,  !- Name
  <%= system_name %> Always On Schedule,  !- Availability Schedule Name
  <%= system_name %> Outside Air Inlet Node,  !- Process Air Inlet Node Name
  <%= system_name %> Desiccant HX Outlet Node,  !- Process Air Outlet Node Name
  <%= system_name %> Regen Coil Outlet Node,  !- Regeneration Air Inlet Node Name
  <%= system_name %> Regen Fan Inlet Node,  !- Regeneration Fan Inlet Node Name
  LeavingMaximumHumidityRatioSetpoint,  !- Control Type
  0.008,                   !- Leaving Maximum Humidity Ratio Setpoint {kg-H2O/kg-air}
<%# NOTE: This object does not support autosizing! %>
  <%= oa_system %>,        !- Nominal Process Air Flow Rate {m3/s}
  2.5,                     !- Nominal Process Air Velocity {m/s}
  10,                      !- Rotor Power {W}
  Coil:Heating:Fuel,       !- Regeneration Coil Object Type
  <%= system_name %> Desiccant Regen Coil,  !- Regeneration Coil Name
  Fan:VariableVolume,      !- Regeneration Fan Object Type
  <%= system_name %> Desiccant Regen Fan,  !- Regeneration Fan Name
  Default;                 !- Performance Model Type

Fan:VariableVolume,
  <%= system_name %> Desiccant Regen Fan,  !- Name
  <%= system_name %> Operation Schedule,  !- Availability Schedule Name
  <%= oa_desicc_fan_eff %>,  !- Fan Efficiency
  <%= oa_desicc_fan_rise %>,  !- Pressure Rise {Pa}
  <%= oa_system %>,        !- Maximum Flow Rate {m3/s}
  Fraction,                !- Fan Power Minimum Flow Rate Input Method
  1.0,                     !- Fan Power Minimum Flow Fraction {}
  ,                        !- Fan Power Minimum Flow Rate {m3/s}
  0.9,                     !- Motor Efficiency
  1.0,                     !- Motor In Airstream Fraction
  0,                       !- Fan Power Coefficient 1
  1,                       !- Fan Power Coefficient 2
  0,                       !- Fan Power Coefficient 3
  0,                       !- Fan Power Coefficient 4
  0,                       !- Fan Power Coefficient 5
  <%= system_name %> Regen Fan Inlet Node,  !- Air Inlet Node Name
  <%= system_name %> Regen Fan Outlet Node;  !- Air Outlet Node Name

<%# Air1 Regen Fan Inlet Node could be relief air instead of outdoor air %>

OutdoorAir:Node,
  <%= system_name %> Regen Fan Inlet Node;  !- Name

Coil:Heating:Fuel,
  <%= system_name %> Desiccant Regen Coil,  !- Name
  <%= system_name %> Always On Schedule,  !- Availability Schedule Name
  NaturalGas,              !- Fuel Type
  1.0,                     !- Gas Burner Efficiency
  100000,                  !- Nominal Capacity {W}
  <%= system_name %> Regen Fan Outlet Node,  !- Air Inlet Node Name
  <%= system_name %> Regen Coil Outlet Node;  !- Air Outlet Node Name

<%#
Meter:Custom,
  Desiccant Regen Energy,  !- Name
  NaturalGas,              !- Fuel Type
  Air1 Desiccant Regen Coil,  !- Key Name 1
  Heating Coil Gas Consumption;  !- Report Variable or Meter Name 1
%>
<% end %>

<% if (oa_energy_recovery) %>

<%#
NOTE:  For HeatExchanger controls to work properly must also set the appropriate controls
on Controller:OutdoorAir.  Specifically Economizer Control Type should be set to FixedDryBulb
(or similar--just not NoEconomizer, even if it's a DOAS).  Economizer Maximum and Minimum Limit
Dry-Bulb Temperatures are used to define when the HeatExchanger should run.
Economizer Control Types for DifferentialDryBulb and DifferentialEnthalpy can also be used.

UPDATE:  Default behavior for the HeatExchanger is to turn off when the Controller:OutdoorAir
activates economizing.  To get the HeatExchanger to run, Economizer Lockout must be set to No.
In this case, it appears that Supply Air Outlet Temperature Control frequently does not work
correctly!  The HeatExchanger sometimes overheats beyond the OutdoorAirPretreat setpoint
requiring extra cooling.  There is no apparent workaround.

UPDATE:  An economizer control other than "NoEconomizer" on Controller:OutdoorAir is required
in order to activate the economizer controls that allow heat recovery to be locked out.  When
the outdoor temperature is warm enough that heat recovery would result in unnecessary cooling,
it should be locked out.  Economizer Lockout must be set to "Yes" for the HeatExchanger.
%>
HeatExchanger:AirToAir:SensibleAndLatent,
  <%= system_name %> Energy Recovery Wheel,  !- Name
  <%= system_name %> Always On Schedule,  !- Availability Schedule Name
  Autosize,                !- Nominal Supply Air Flow Rate {m3/s}
  <%= oa_er_sensible_eff %>,  !- Sensible Effectiveness at 100% Heating Air Flow {}
  <%= oa_er_latent_eff %>,  !- Latent Effectiveness at 100% Heating Air Flow {}
  <%= oa_er_sensible_eff %>,  !- Sensible Effectiveness at 75% Heating Air Flow {}
  <%= oa_er_latent_eff %>,  !- Latent Effectiveness at 75% Heating Air Flow {}
  <%= oa_er_sensible_eff %>,  !- Sensible Effectiveness at 100% Cooling Air Flow {}
  <%= oa_er_latent_eff %>,  !- Latent Effectiveness at 100% Cooling Air Flow {}
  <%= oa_er_sensible_eff %>,  !- Sensible Effectiveness at 75% Cooling Air Flow {}
  <%= oa_er_latent_eff %>,  !- Latent Effectiveness at 75% Cooling Air Flow {}
<% if (oa_desiccant_hx) %>
  <%= system_name %> Desiccant HX Outlet Node,  !- Supply Air Inlet Node Name
<% else %>
  <%= system_name %> Outside Air Inlet Node,  !- Supply Air Inlet Node Name
<% end %>
  <%= system_name %> ER Supply Outlet Node,  !- Supply Air Outlet Node Name
  <%= system_name %> OA Relief Node,  !- Exhaust Air Inlet Node Name
  <%= system_name %> ER Exhaust Outlet Node,  !- Exhaust Air Outlet Node Name
  260,                     !- Nominal Electric Power {W}
  Yes,                     !- Supply Air Outlet Temperature Control
  Rotary,                  !- Heat Exchanger Type
  None,                    !- Frost Control Type
  ,                        !- Threshold Temperature {C}
  ,                        !- Initial Defrost Time Fraction
  ,                        !- Rate of Defrost Time Fraction Increase
  Yes;                     !- Economizer Lockout
<% end %>

<%#
WARNING: For EvaporativeCooler:Indirect:ResearchSpecial, a Secondary Fan Flow Rate of zero causes a hard crash
for variable flow air systems (probably doing a divide by zero).  Use a very small flow rate to simulate no
extra fan energy from the secondary fan, e.g., when secondary air is return air.
%>

<% if (oa_indirect_evap) %>
EvaporativeCooler:Indirect:ResearchSpecial,
  <%= system_name %> Indirect Evap Cooler,  !- Name
  <%= system_name %> Always On Schedule,  !- Availability Schedule Name
  <%= oa_ind_evap_wb_eff %>,  !- Cooler Wetbulb Design Effectiveness
  ,                        !- Wetbulb Effectiveness Flow Ratio Modifier Curve Name
  <%= oa_ind_evap_db_eff %>,                        !- Cooler Drybulb Design Effectiveness
  ,                        !- Drybulb Effectiveness Flow Ratio Modifier Curve Name
  Autosize,                       !- Recirculating Water Pump Design Power {W}
  <%= oa_ind_evap_pump_factor %>,                       !- Water Pump Power Sizing Factor {W/(m3/s)}
  ,                        !- Water Pump Power Modifier Curve Name
  0.000001,  !Autosize,                !- Secondary Air Design Flow Rate {m3/s}
  1.0,  !0.6,                     !- Secondary Air Flow Scaling Factor
  Autosize,                       !- Secondary Air Fan Design Power {W}
  <%= oa_ind_evap_fan_factor %>,                     !- Secondary Air Fan Sizing Specific Power {W/(m3/s)}
  ,                        !- Secondary Air Fan Power Modifier Curve Name
<% if (oa_energy_recovery) %>
  <%= system_name %> ER Supply Outlet Node,  !- Primary Air Inlet Node Name
<% elsif (oa_desiccant_hx) %>
  <%= system_name %> Desiccant HX Outlet Node,  !- Primary Air Inlet Node Name
<% else %>
  <%= system_name %> Outside Air Inlet Node,  !- Primary Air Inlet Node Name
<% end %>
  <%= system_name %> IEC Outlet Node,  !- Primary Air Outlet Node Name
  Autosize,                       !- Primary Design Air Flow Rate {m3/s}
  0.9,                     !- Dewpoint Effectiveness Factor
  <%= system_name %> IEC Secondary Inlet Node,  !- Secondary Air Inlet Node Name
  <%= system_name %> IEC Secondary Inlet Node,  !- Secondary Air Outlet Node Name
  <%= system_name %> IEC Outlet Node,  !- Sensor Node Name
<% if (oa_ind_evap_secondary == "OUTDOORS") %>
  ,                        !- Relief Air Inlet Node Name
<% else %>
  <%= system_name %> OA Relief Node,  !- Relief Air Inlet Node Name
<% end %>
  <%= clear_water_supply_tank %>,                        !- Water Supply Storage Tank Name
  0,                       !- Drift Loss Fraction
  4.0;                     !- Blowdown Concentration Ratio

OutdoorAir:Node,
  <%= system_name %> IEC Secondary Inlet Node;  !- Name
<% end %>

SetpointManager:OutdoorAirPretreat,
  <%= system_name %> OA Setpoint Manager,  !- Name
  Temperature,             !- Control Variable
  ,                        !- Minimum Setpoint Temperature {C}
  ,                        !- Maximum Setpoint Temperature {C}
  ,                        !- Minimum Setpoint Humidity Ratio {kgWater/kgDryAir}
  ,                        !- Maximum Setpoint Humidity Ratio {kgWater/kgDryAir}
  <%= system_name %> OA Outlet Node,  !- Reference Setpoint Node Name
  <%= system_name %> OA Outlet Node,  !- Mixed Air Stream Node Name
  <%= system_name %> Outside Air Inlet Node,  !- Outdoor Air Stream Node Name
  <%= system_name %> Supply Equipment Inlet Node,  !- Return Air Stream Node Name
  <%= system_name %> OA Setpoint Nodes;  !- Setpoint Node or NodeList Name

NodeList,
  <%= system_name %> OA Setpoint Nodes,  !- Name
<% if (oa_desiccant_hx) %>
  <%= system_name %> Desiccant HX Outlet Node,  !- Node Name
<% end %>
<% if (oa_energy_recovery) %>
  <%= system_name %> ER Supply Outlet Node,  !- Node Name
<% end %>
<% if (oa_indirect_evap) %>
  <%= system_name %> IEC Outlet Node,  !- Node Name
<% end %>
<%# Include OA Inlet Node just to be able to terminate the NodeList cleanly. %>
  <%= system_name %> Outside Air Inlet Node;  !- Node Name

OutdoorAir:Mixer,
  <%= system_name %> OA Mixer,  !- Name
  <%= system_name %> OA Outlet Node,  !- Mixed Air Node Name
<% if (oa_indirect_evap) %>
  <%= system_name %> IEC Outlet Node,  !- Outdoor Air Stream Node Name
<% elsif (oa_energy_recovery) %>
  <%= system_name %> ER Supply Outlet Node,  !- Outdoor Air Stream Node Name
<% elsif (oa_desiccant_hx) %>
  <%= system_name %> Desiccant HX Outlet Node,  !- Outdoor Air Stream Node Name
<% else %>
  <%= system_name %> Outside Air Inlet Node,  !- Outdoor Air Stream Node Name
<% end %>
  <%= system_name %> OA Relief Node,  !- Relief Air Stream Node Name
  <%= system_name %> Supply Equipment Inlet Node;  !- Return Air Stream Node Name

<%#
NOTE: There is a problem with the controls on HeatExchanger:AirToAir:SensibleAndLatent. The bypass controls only
appear to work if an economizer is enabled AND actively operating. Otherwise the Supply Air Outlet Temperature Control
is ignored, even with the proper setpoint manager.

In general, this means that energy recovery WITHOUT an economizer is a bad combination. Under some conditions the
energy recovery wheel will overheat the outdoor air and result in unnecessary cooling. There is no apparent
workaround, although an EMS override might be possible.

For DOAS--which does not normally economize--Economizer Control Type should be set to FixedDryBulb (or similar--
just not NoEconomizer) in order to use energy recovery. ALSO (need to recheck): Setting the Economizer Minimum Limit
to SAT - 1.0 C (roughly optimal), disables the economizer below this value and allows heat recovery to operate; above
the value locks it out.
%>
Controller:OutdoorAir,
  <%= system_name %> OA Controller,  !- Name
  <%= system_name %> OA Relief Node,  !- Relief Air Outlet Node Name
  <%= system_name %> Supply Equipment Inlet Node,  !- Return Air Node Name
  <%= system_name %> OA Outlet Node,  !- Mixed Air Node Name
  <%= system_name %> Outside Air Inlet Node,  !- Actuator Node Name
  Autosize,                !- Minimum Outdoor Air Flow Rate {m3/s}
  Autosize,                !- Maximum Outdoor Air Flow Rate {m3/s}
<% if (oa_economizer) %>
  DifferentialDryBulb,    !- Economizer Control Type
<% else %>
  NoEconomizer,            !- Economizer Control Type
<% end %>
  ModulateFlow,            !- Economizer Control Action Type
  <%= oa_econ_high_limit %>,  !<%= sat_high_temp %>,    !- Economizer Maximum Limit Dry-Bulb Temperature {C}
  ,                        !- Economizer Maximum Limit Enthalpy {J/kg}
  ,                        !- Economizer Maximum Limit Dewpoint Temperature {C}
  ,                        !- Electronic Enthalpy Limit Curve Name
  ,  !<%= sat_high_temp - 1.0 %>,  !- Economizer Minimum Limit Dry-Bulb Temperature {C}
  NoLockout,               !- Lockout Type
  FixedMinimum,            !- Minimum Limit Type
<%# NOTE:  Not working right yet...Outdoor Air Schedule is not being honored when the fan cycles on at night. %>
  <%= system_name %> Outdoor Air Schedule,  !- Minimum Outdoor Air Schedule Name
  ,                        !- Minimum Fraction of Outdoor Air Schedule Name
  ,                        !- Maximum Fraction of Outdoor Air Schedule Name
  ,                        !- Mechanical Ventilation Controller Name
  ,                        !- Time of Day Economizer Control Schedule Name
  ,                        !- High Humidity Control
  ,                        !- Humidistat Control Zone Name
  ,                        !- High Humidity Outdoor Air Flow Ratio
  ,                        !- Control High Indoor Humidity Based on Outdoor Humidity Ratio
  BypassWhenWithinEconomizerLimits;  !- Heat Recovery Bypass Control Type

SetpointManager:MixedAir,
  <%= system_name %> Mixed Air Setpoint Manager,  !- Name
  Temperature,             !- Control Variable
  <%= system_name %> Supply Equipment Outlet Node,  !- Reference Setpoint Node Name
  <%= system_name %> OA Outlet Node, !- Fan Inlet Node Name
  <%= system_name %> Supply Fan Outlet Node,  !- Fan Outlet Node Name
  <%= system_name %> Mixed Air Setpoint Nodes;  !- Setpoint Node or NodeList Name

NodeList,
  <%= system_name %> Mixed Air Setpoint Nodes,  !- Name
<%# List OA Outlet Node last just to be able to terminate the NodeList cleanly. %>
  <%= system_name %> OA Outlet Node;  !- Node Name

SetpointManager:SingleZone:Reheat,
  <%= system_name %> SupAirTemp Manager,   !- Name
  Temperature,             !- Control Variable
  10.0,                    !- Minimum Supply Air Temperature {C}
  50.0,                    !- Maximum Supply Air Temperature {C}
  <%= control_zone_name %>,        !- Control Zone Name
  <%= control_zone_name %> Air Node,  !- Zone Node Name
  <%= control_zone_name %> ATU Outlet Node,  !- Zone Inlet Node Name
  <%= system_name %> Supply Equipment Outlet Node;  !- Setpoint Node or NodeList Name

<% if (cooling_coil_type == "DX" and comp_speeds == 1) %>

AirLoopHVAC:UnitaryHeatCool,
  <%= system_name %> Unitary,    !- Name
  <%= system_name %> Operation Schedule,  !- Availability Schedule Name
  <%= system_name %> OA Outlet Node,  !- Air Inlet Node Name
  <%= system_name %> Supply Equipment Outlet Node,  !- Air Outlet Node Name
  <%= system_name %> Fan Operation Schedule,  !- Supply Air Fan Operating Mode Schedule Name
  <%= sat_high_temp %>,          !- Maximum Supply Air Temperature {C}
  <%= fan_flow_supply %>,        !- Supply Air Flow Rate During Cooling Operation {m/s}
  <%= fan_flow_supply %>,        !- Supply Air Flow Rate During Heating Operation {m/s}
  0,                             !- Supply Air Flow Rate When No Cooling or Heating is Needed {m/s}
  <%= control_zone_name %>,      !- Controlling Zone or Thermostat Location
  Fan:OnOff,                     !- Supply Fan Object Type
  <%= system_name %> Supply Fan, !- Supply Fan Name
  BlowThrough,                   !- Fan Placement
  <% if (heating_coil_type == "GAS") %>
  Coil:Heating:Fuel,             !- Heating Coil Object Type
  <% else %>
  Coil:Heating:Electric,         !- Heating Coil Object Type
  <% end %>
  <%= system_name %> Heating Coil,  !- Heating Coil Name
  Coil:Cooling:DX:SingleSpeed,   !- Cooling Coil Object Type
  <%= system_name %> Cooling Coil,  !- Cooling Coil Name
  None;                          !- Dehumidification Control Type

<% elsif ((heating_coil_type == "GAS" || heating_coil_type == "ELECTRIC") && (cooling_coil_type == "NONE")) %>

AirLoopHVAC:UnitaryHeatOnly,
  <%= system_name %> Unitary,    !- Name
  <%= system_name %> Operation Schedule,  !- Availability Schedule Name
  <%= system_name %> OA Outlet Node,  !- Air Inlet Node Name
  <%= system_name %> Supply Equipment Outlet Node,  !- Air Outlet Node Name
  <%= system_name %> Fan Operation Schedule,  !- Supply Air Fan Operating Mode Schedule Name
  <%= sat_high_temp %>,          !- Maximum Supply Air Temperature {C}
  <%= fan_flow_supply %>,        !- Supply Air Flow Rate {m/s}
  <%= control_zone_name %>,      !- Controlling Zone or Thermostat Location
  Fan:OnOff,                     !- Supply Fan Object Type
  <%= system_name %> Supply Fan, !- Supply Fan Name
  BlowThrough,                   !- Fan Placement
  <% if (heating_coil_type == "ELECTRIC") %>
  Coil:Heating:Electric,         !- Heating Coil Object Type
  <% else %>
  Coil:Heating:Fuel,             !- Heating Coil Object Type
  <% end %>
  <%= system_name %> Heating Coil;  !- Heating Coil Name

<% elsif (heating_coil_type == "ASHP" and cooling_coil_type == "ASHP" and comp_speeds == 1) %>

AirLoopHVAC:UnitaryHeatPump:AirToAir,
  <%= system_name %> Unitary,    !- Name
  <%= system_name %> Operation Schedule,  !- Availability Schedule Name
  <%= system_name %> OA Outlet Node,  !- Air Inlet Node Name
  <%= system_name %> Supply Equipment Outlet Node,  !- Air Outlet Node Name
  <%= fan_flow_supply %>,        !- Supply Air Flow Rate During Cooling Operation {m/s}
  <%= fan_flow_supply %>,        !- Supply Air Flow Rate During Heating Operation {m/s}
  0,                             !- Supply Air Flow Rate When No Cooling or Heating is Needed {m/s}
  <%= control_zone_name %>,      !- Controlling Zone or Thermostat Location
  Fan:OnOff,                     !- Supply Fan Object Type
  <%= system_name %> Supply Fan, !- Supply Fan Name
  Coil:Heating:DX:SingleSpeed,   !- Heating Coil Object Type
  <%= system_name %> Heating Coil,  !- Heating Coil Name
  Coil:Cooling:DX:SingleSpeed,   !- Cooling Coil Object Type
  <%= system_name %> Cooling Coil,  !- Cooling Coil Name
  <% if (hp_supp_heat_coil_type == "ELECTRIC") %>
  Coil:Heating:Electric,         !- Supplemental Heating Coil Object Type
  <% elsif (hp_supp_heat_coil_type == "GAS") %>
  Coil:Heating:Fuel,             !- Supplemental Heating Coil Object Type
  <% else %>
  Coil:Heating:Electric,         !- Supplemental Heating Coil Object Type
  <% end %>
  <%= system_name %> Supp Heating Coil,  !- Supplemental Heating Coil Name
  <%= hp_supply_max_temp %>,     !- Maximum Supply Air Temperature for Supplemental Heat {C}
  <%= hp_supp_heat_max_temp %>,  !- Maximum Outdoor Dry-Bulb Temperature for Supplemental Heater Operation {C}
  BlowThrough,                   !- Fan Placement
  <%= system_name %> Fan Operation Schedule;  !- Supply Air Fan Operating Mode Schedule Name

<% elsif (((heating_coil_type == "ASHP" and cooling_coil_type == "ASHP") or cooling_coil_type == "DX") and comp_speeds > 1) %>

AirLoopHVAC:UnitaryHeatPump:AirToAir:MultiSpeed,
  <%= system_name %> Unitary,    !- Name
  <%= system_name %> Operation Schedule,  !- Availability Schedule Name
  <%= system_name %> OA Outlet Node,  !- Air Inlet Node Name
  <%= system_name %> Supply Equipment Outlet Node,  !- Air Outlet Node Name
  <%= control_zone_name %>,      !- Controlling Zone or Thermostat Location
  Fan:OnOff,                     !- Supply Fan Object Type
  <%= system_name %> Supply Fan, !- Supply Fan Name
  BlowThrough,                   !- Fan Placement
  <%= system_name %> Fan Operation Schedule,  !- Supply Air Fan Operating Mode Schedule Name
  <% if (heating_coil_type == "ASHP") %>
  Coil:Heating:DX:MultiSpeed,    !- Heating Coil Object Type
  <%= system_name %> Heating Coil,  !- Heating Coil Name
  <%= hp_min_temp %>,            !- Minimum Outdoor Dry-Bulb Temperature for Compressor Operation {C}
  Coil:Cooling:DX:MultiSpeed,    !- Cooling Coil Object Type
  <%= system_name %> Cooling Coil,  !- Cooling Coil Name
    <% if (hp_supp_heat_coil_type == "ELECTRIC") %>
  Coil:Heating:Electric,         !- Supplemental Heating Coil Object Type
    <% elsif (hp_supp_heat_coil_type == "GAS") %>
  Coil:Heating:Fuel,             !- Supplemental Heating Coil Object Type
    <% else %>
  Coil:Heating:Electric,         !- Supplemental Heating Coil Object Type
    <% end %>
  <%= system_name %> Supp Heating Coil,  !- Supplemental Heating Coil Name
  <%= hp_supply_max_temp %>,     !- Maximum Supply Air Temperature for Supplemental Heat {C}
  <%= hp_supp_heat_max_temp %>,  !- Maximum Outdoor Dry-Bulb Temperature for Supplemental Heater Operation {C}
  <% elsif (heating_coil_type == "ELECTRIC") %>
  Coil:Heating:Gas:MultiStage,    !- Heating Coil Object Type
  <%= system_name %> Dummy Heating Coil,  !- Heating Coil Name
  -20,                           !- Minimum Outdoor Dry-Bulb Temperature for Compressor Operation {C}
  Coil:Cooling:DX:MultiSpeed,    !- Cooling Coil Object Type
  <%= system_name %> Cooling Coil,  !- Cooling Coil Name
  Coil:Heating:Electric,         !- Supplemental Heating Coil Object Type
  <%= system_name %> Heating Coil,  !- Supplemental Heating Coil Name
  <%= hp_supply_max_temp %>,     !- Maximum Supply Air Temperature for Supplemental Heat {C}
  21,                            !- Maximum Outdoor Dry-Bulb Temperature for Supplemental Heater Operation {C}
  <% elsif (heating_coil_type == "GAS") %>
  Coil:Heating:Gas:MultiStage,    !- Heating Coil Object Type
  <%= system_name %> Dummy Heating Coil,  !- Heating Coil Name
  -20,                           !- Minimum Outdoor Dry-Bulb Temperature for Compressor Operation {C}
  Coil:Cooling:DX:MultiSpeed,    !- Cooling Coil Object Type
  <%= system_name %> Cooling Coil,  !- Cooling Coil Name
  Coil:Heating:Fuel,             !- Supplemental Heating Coil Object Type
  <%= system_name %> Heating Coil,  !- Supplemental Heating Coil Name
  <%= hp_supply_max_temp %>,     !- Maximum Supply Air Temperature for Supplemental Heat {C}
  21,                            !- Maximum Outdoor Dry-Bulb Temperature for Supplemental Heater Operation {C}
  <% else %>
  Coil:Heating:Gas:MultiStage,    !- Heating Coil Object Type
  <%= system_name %> Dummy Heating Coil,  !- Heating Coil Name
  -20,                           !- Minimum Outdoor Dry-Bulb Temperature for Compressor Operation {C}
  Coil:Cooling:DX:MultiSpeed,    !- Cooling Coil Object Type
  <%= system_name %> Cooling Coil,  !- Cooling Coil Name
  Coil:Heating:Fuel,             !- Supplemental Heating Coil Object Type
  <%= system_name %> Heating Coil,  !- Supplemental Heating Coil Name
  <%= hp_supply_max_temp %>,     !- Maximum Supply Air Temperature for Supplemental Heat {C}
  21,                            !- Maximum Outdoor Dry-Bulb Temperature for Supplemental Heater Operation {C}
  <% end %>
   0,                            !- Auxiliary On-Cycle Electric Power {W}
   0,                            !- Auxiliary Off-Cycle Electric Power {W}
   ,                             !- Design Heat Recovery Water Flow rate {m^3/s}
   ,                             !- Maximum Temperature for Heat Recovery {C}
   ,                             !- Heat Recovery Water Inlet Node Name
   ,                             !- Heat Recovery Water Outlet Node Name
   0,                            !- Supply Air Flow Rate When No Cooling or Heating is Needed {m/s}
   <%= comp_speeds %>,           !- Number of Speeds for Heating
   <%= comp_speeds %>,           !- Number of Speeds for Cooling
   Autosize,                     !- Speed 1 Supply Air Flow Rate During Heating Operation {m3/s}
   Autosize,                     !- Speed 2 Supply Air Flow Rate During Heating Operation {m3/s}
   Autosize,                     !- Speed 3 Supply Air Flow Rate During Heating Operation {m3/s}
   Autosize,                     !- Speed 4 Supply Air Flow Rate During Heating Operation {m3/s}
   Autosize,                     !- Speed 1 Supply Air Flow Rate During Cooling Operation {m3/s}
   Autosize,                     !- Speed 2 Supply Air Flow Rate During Cooling Operation {m3/s}
   Autosize,                     !- Speed 3 Supply Air Flow Rate During Cooling Operation {m3/s}
   Autosize;                     !- Speed 4 Supply Air Flow Rate During Cooling Operation {m3/s}

<% elsif (heating_coil_type == "WSHP" and cooling_coil_type == "WSHP") %>

AirLoopHVAC:UnitaryHeatPump:WaterToAir,
  <%= system_name %> Unitary,    !- Name
  <%= system_name %> Operation Schedule,  !- Availability Schedule Name
  <%= system_name %> OA Outlet Node,  !- Air Inlet Node Name
  <%= system_name %> Supply Equipment Outlet Node,  !- Air Outlet Node Name
  <%= fan_flow_supply %>,        !- Supply Air Flow Rate {m3/s}
  <%= control_zone_name %>,      !- Controlling Zone or Thermostat Location
  Fan:OnOff,                     !- Supply Fan Object Type
  <%= system_name %> Supply Fan, !- Supply Fan Name
  Coil:Heating:WaterToAirHeatPump:EquationFit,   !- Heating Coil Object Type
  <%= system_name %> Heating Coil,  !- Heating Coil Name
  0.001,                         !- Heating Convergence
  Coil:Cooling:WaterToAirHeatPump:EquationFit,   !- Cooling Coil Object Type
  <%= system_name %> Cooling Coil,  !- Cooling Coil Name
  0.001,                         !- Cooling Convergence
  2.5,                                           !- Maximum Cycling Rate {cycles/hr}
  60,                                            !- Heat Pump Time Constant {s}
  0.01,                                          !- Fraction of On-Cycle Power Use
  60,                                            !- Heat Pump Fan Delay Time {s}
  <% if (hp_supp_heat_coil_type == "ELECTRIC") %>
  Coil:Heating:Electric,         !- Supplemental Heating Coil Object Type
  <% elsif (hp_supp_heat_coil_type == "GAS") %>
  Coil:Heating:Fuel,             !- Supplemental Heating Coil Object Type
  <% else %>
  Coil:Heating:Electric,         !- Supplemental Heating Coil Object Type
  <% end %>
  <%= system_name %> Supp Heating Coil,  !- Supplemental Heating Coil Name
  <%= hp_supply_max_temp %>,     !- Maximum Supply Air Temperature for Supplemental Heat {C}
  <%= hp_supp_heat_max_temp %>,  !- Maximum Outdoor Dry-Bulb Temperature for Supplemental Heater Operation {C}
  ,                              !- Outdoor Dry-Bulb Temperature Sensor Node Name
  BlowThrough,                   !- Fan Placement
  <%= system_name %> Fan Operation Schedule,  !- Supply Air Fan Operating Mode Schedule Name
  ,                                              !- Dehumidification Control Type
  Cycling;                                       !- Heat Pump Coil Water Flow Mode

<% end %>

Schedule:Constant,
  <%= system_name %> Fan Operation Schedule,  !- Name
  Any Number,                    !- Schedule Type Limits Name
  0;                             !- Hourly Value

Fan:OnOff,
  <%= system_name %> Supply Fan,  !- Name
  <%= system_name %> Operation Schedule,  !- Availability Schedule Name
  <%= fan_eff_supply %>,     !- Fan Efficiency
  <%= fan_rise_supply %>,    !- Pressure Rise {Pa}
  <%= fan_flow_supply %>,    !- Maximum Flow Rate {m^3/s}
  0.85,                      !- Motor Efficiency
  1.0,                       !- Motor In Airstream Fraction
  <%= system_name %> OA Outlet Node,  !- Air Inlet Node Name
  <%= system_name %> Supply Fan Outlet Node;   !- Air Outlet Node Name

<% if (cooling_coil_type == "DX" || cooling_coil_type == "ASHP") and comp_speeds == 1 %>

Coil:Cooling:DX:SingleSpeed,
  <%= system_name %> Cooling Coil,  !- Name
  <%= system_name %> Operation Schedule,  !- Availability Schedule Name
  <%= cooling_coil_cap %>,   !- Rated High Speed Total Cooling Capacity {W}
  Autosize,                  !- Rated High Speed Sensible Heat Ratio
  <%= cooling_coil_cop %>,   !- Rated High Speed COP
  <%= fan_flow_supply %>,    !- Rated High Speed Air Flow Rate {m^3/s}
  ,                          !- Rated Evaporator Fan Power Per Volume Flow Rate {W/(m^3/s)}
  <%= system_name %> Supply Fan Outlet Node,  !- Air Inlet Node Name
  <%= system_name %> Cooling Coil Outlet Node,  !- Air Outlet Node Name
  <%= system_name %> Cool-Cap-fT,  !- Total Cooling Capacity Function of Temperature Curve Name
  <%= system_name %> Cool-Cap-fFF,  !- Total Cooling Capacity Function of Flow Fraction Curve Name
  <%= system_name %> Cool-EIR-fT,  !- Energy Input Ratio Function of Temperature Curve Name
  <%= system_name %> Cool-EIR-fFF,  !- Energy Input Ratio Function of Flow Fraction Curve Name
  <%= system_name %> Cool-PLF-fPLR,  !- Part Load Fraction Correlation Curve Name
  -25.0,                     !- Minimum Outdoor Dry-Bulb Temperature for Compressor Operation (C)
  1000,                      !- Nominal Time for Condensate Removal to Begin {s}
  1.5,                       !- Ratio of Initial Moisture Evaporation Rate and Steady State Latent Capacity
  3,                         !- Maximum Cycling Rate {cycles/hr}
  45,                        !- Latent Capacity Time Constant {s}
  ,                          !- Condenser Air Inlet Node Name
  AirCooled,                 !- Condenser Type
  ,                          !- Evaporative Condenser Effectiveness
  ,                          !- Evaporative Condenser Air Flow Rate {m^3/s}
  ,                          !- Evaporative Condenser Pump Rated Power Consumption {W}
  <%= crankcase_cap %>,   !- Crankcase Heater Capacity {W}
  <%= crankcase_max_temp %>,  !- Maximum Outdoor Dry-Bulb Temperature for Crankcase Heater Operation {C}
  ,                        !- Supply Water Storage Tank Name
  <%= clear_water_storage_tank %>;                        !- Condensate Collection Water Storage Tank Name

  <% if (cooling_coil_type == "ASHP") %>
! Following performance curves taken from single-speed ASHP system in BeOpt

Curve:Biquadratic,
   <%= system_name %> Cool-Cap-fT,   !- Name
   1.5573597060000006,-0.0744481692,0.00309859668,0.0014595786,-0.000041148,-0.00042671448,   !- Coefficients (list)
   13.88,         !- Minimum Value of x
   23.88,         !- Maximum Value of x
   18.33,         !- Minimum Value of y
   51.66;         !- Maximum Value of y

Curve:Biquadratic,
   <%= system_name %> Cool-EIR-fT,   !- Name
   -0.3504476949999999,0.116809893,-0.00339950844,-0.001226088,0.0006008094,-0.000466884,   !- Coefficients (List)
   13.88,         !- Minimum Value of x
   23.88,         !- Maximum Value of x
   18.33,         !- Minimum Value of y
   51.66;         !- Maximum Value of y

Curve:Quadratic,
   <%= system_name %> Cool-PLF-fPLR,   !- Name
   <%= 1 - cooling_coil_cd %>,<%= cooling_coil_cd %>,0,     !- Coefficients (List)
   0,               !- Minimum Value of x
   1,               !- Maximum Value of x
   0.7,             !- Minimum Value of y
   1;               !- Maximum Value of y

Curve:Quadratic,
   <%= system_name %> Cool-Cap-fFF,  !- Name
   0.718664047,0.41797409,-0.136638137,   !- Coefficients (List)
   0,                                     !- Minimum Value of x
   2,                                     !- Maximum Value of x
   0,                                     !- Minimum Value of y
   2;                                     !- Maximum Value of y

Curve:Quadratic,
   <%= system_name %> Cool-EIR-fFF,  !- Name
   1.143487507,-0.13943972,-0.004047787,   !- Coefficients (List)
   0,                                      !- Minimum Value of x
   2,                                      !- Maximum Value of x
   0,                                      !- Minimum Value of y
   2;                                      !- Maximum Value of y
  <% elsif (cooling_coil_type == "DX") %>
! Following performance curves taken from single-speed DX system in BeOpt

Curve:Biquadratic,
   <%= system_name %> Cool-Cap-fT,   !- Name
   1.5509020010000003,-0.0750500892,0.00309713544,0.00240111,-0.000050544,-0.00042728148,   !- Coefficients (list)
   13.88,         !- Minimum Value of x
   23.88,         !- Maximum Value of x
   18.33,         !- Minimum Value of y
   51.66;         !- Maximum Value of y

Curve:Biquadratic,
   <%= system_name %> Cool-EIR-fT,   !- Name
   -0.3042829970000005,0.1180477062,-0.00342466704,-0.0062619138,0.00069542712,-0.00046997496,   !- Coefficients (List)
   13.88,         !- Minimum Value of x
   23.88,         !- Maximum Value of x
   18.33,         !- Minimum Value of y
   51.66;         !- Maximum Value of y

Curve:Quadratic,
   <%= system_name %> Cool-PLF-fPLR,               !- Name
   <%= 1 - cooling_coil_cd %>,<%= cooling_coil_cd %>,0,     !- Coefficients (List)
   0,                           !- Minimum Value of x
   1,                           !- Maximum Value of x
   0.7,                         !- Minimum Value of y
   1;                           !- Maximum Value of y

Curve:Quadratic,
   <%= system_name %> Cool-Cap-fFF,                           !- Name
   0.718605468,0.410099989,-0.128705457,   !- Coefficients (List)
   0,                                      !- Minimum Value of x
   2,                                      !- Maximum Value of x
   0,                                      !- Minimum Value of y
   2;                                      !- Maximum Value of y

Curve:Quadratic,
   <%= system_name %> Cool-EIR-fFF,                          !- Name
   1.32299905,-0.477711207,0.154712157,   !- Coefficients (List)
   0,                                     !- Minimum Value of x
   2,                                     !- Maximum Value of x
   0,                                     !- Minimum Value of y
   2;                                     !- Maximum Value of y
  <% end %>

<% elsif ((cooling_coil_type == "ASHP" or cooling_coil_type == "DX") and comp_speeds > 1) %>

Coil:Cooling:DX:MultiSpeed,
  <%= system_name %> Cooling Coil,  !- Name
  <%= system_name %> Operation Schedule,  !- Availability Schedule Name
  <%= system_name %> Supply Fan Outlet Node,  !- Air Inlet Node Name
  <%= system_name %> Cooling Coil Outlet Node,  !- Air Outlet Node Name
  ,                          !- Condenser Air Inlet Node Name
  AirCooled,                 !- Condenser Type
  -25.0,                     !- Minimum Outdoor Dry-Bulb Temperature for Compressor Operation (C)
  ,                          !- Supply Water Storage Tank Name
  <%= clear_water_storage_tank %>, !- Condensate Collection Water Storage Tank Name
  No,                        !- Apply Part Load Fraction to Speeds Greater than 1
  No,                        !- Apply Latent Degradation to Speeds Greater than 1
  <%= crankcase_cap %>,   !- Crankcase Heater Capacity {W}
  <%= crankcase_max_temp %>,  !- Maximum Outdoor Dry-Bulb Temperature for Crankcase Heater Operation {C}
  ,                          !- Basin Heater Capacity
  ,                          !- Basin Heater Setpoint Temperature
  ,                          !- Basin Heater Operating Schedule Name
  Electricity,               !- Fuel Type
  <%= comp_speeds %>,        !- Number of Speeds
  <%= cooling_coil_cap %>,   !- Rated High Speed Total Cooling Capacity {W}
  Autosize,                  !- Rated High Speed Sensible Heat Ratio
  <%= cooling_coil_cop %>, !- Rated High Speed COP
  <%= fan_flow_supply %>,    !- Rated High Speed Air Flow Rate {m^3/s}
  ,                          !- Rated Evaporator Fan Power Per Volume Flow Rate {W/(m^3/s)}
  <%= system_name %> Cool-Cap-fT1,  !- Total Cooling Capacity Function of Temperature Curve Name
  <%= system_name %> Cool-Cap-fFF1,  !- Total Cooling Capacity Function of Flow Fraction Curve Name
  <%= system_name %> Cool-EIR-fT1,  !- Energy Input Ratio Function of Temperature Curve Name
  <%= system_name %> Cool-EIR-fFF1,  !- Energy Input Ratio Function of Flow Fraction Curve Name
  <%= system_name %> Cool-PLF-fPLR1,  !- Part Load Fraction Correlation Curve Name
  1000,                      !- Nominal Time for Condensate Removal to Begin {s}
  1.5,                       !- Ratio of Initial Moisture Evaporation Rate and Steady State Latent Capacity
  3,                         !- Maximum Cycling Rate {cycles/hr}
  45,                        !- Latent Capacity Time Constant {s}
  0.2,                       !- Rated Waste Heat Fraction of Power Input
  <%= system_name %> Cool-Waste,  !- Speed 1 Waste Heat Function of Temperature Curve Name
  ,                          !- Evaporative Condenser Effectiveness
  ,                          !- Evaporative Condenser Air Flow Rate {m^3/s}
  ,                          !- Evaporative Condenser Pump Rated Power Consumption {W}
  Autosize,                  !- Rated High Speed Total Cooling Capacity {W}
  Autosize,                  !- Rated High Speed Sensible Heat Ratio
  <%= cooling_coil_cop_2 %>, !- Rated High Speed COP
  Autosize,                  !- Rated High Speed Air Flow Rate {m^3/s}
  ,                          !- Rated Evaporator Fan Power Per Volume Flow Rate {W/(m^3/s)}
  <%= system_name %> Cool-Cap-fT2,  !- Total Cooling Capacity Function of Temperature Curve Name
  <%= system_name %> Cool-Cap-fFF2,  !- Total Cooling Capacity Function of Flow Fraction Curve Name
  <%= system_name %> Cool-EIR-fT2,  !- Energy Input Ratio Function of Temperature Curve Name
  <%= system_name %> Cool-EIR-fFF2,  !- Energy Input Ratio Function of Flow Fraction Curve Name
  <%= system_name %> Cool-PLF-fPLR2,  !- Part Load Fraction Correlation Curve Name
  1000,                      !- Nominal Time for Condensate Removal to Begin {s}
  1.5,                       !- Ratio of Initial Moisture Evaporation Rate and Steady State Latent Capacity
  3,                         !- Maximum Cycling Rate {cycles/hr}
  45,                        !- Latent Capacity Time Constant {s}
  0.2,                       !- Rated Waste Heat Fraction of Power Input
  <%= system_name %> Cool-Waste,  !- Speed 1 Waste Heat Function of Temperature Curve Name
  ,                          !- Evaporative Condenser Effectiveness
  ,                          !- Evaporative Condenser Air Flow Rate {m^3/s}
  <% if comp_speeds < 3 %>
  ;                          !- Evaporative Condenser Pump Rated Power Consumption {W}
  <% else %>
  ,                          !- Evaporative Condenser Pump Rated Power Consumption {W}
  Autosize,                  !- Rated High Speed Total Cooling Capacity {W}
  Autosize,                  !- Rated High Speed Sensible Heat Ratio
  <%= cooling_coil_cop_3 %>, !- Rated High Speed COP
  Autosize,                  !- Rated High Speed Air Flow Rate {m^3/s}
  ,                          !- Rated Evaporator Fan Power Per Volume Flow Rate {W/(m^3/s)}
  <%= system_name %> Cool-Cap-fT3,  !- Total Cooling Capacity Function of Temperature Curve Name
  <%= system_name %> Cool-Cap-fFF3,  !- Total Cooling Capacity Function of Flow Fraction Curve Name
  <%= system_name %> Cool-EIR-fT3,  !- Energy Input Ratio Function of Temperature Curve Name
  <%= system_name %> Cool-EIR-fFF3,  !- Energy Input Ratio Function of Flow Fraction Curve Name
  <%= system_name %> Cool-PLF-fPLR3,  !- Part Load Fraction Correlation Curve Name
  1000,                      !- Nominal Time for Condensate Removal to Begin {s}
  1.5,                       !- Ratio of Initial Moisture Evaporation Rate and Steady State Latent Capacity
  3,                         !- Maximum Cycling Rate {cycles/hr}
  45,                        !- Latent Capacity Time Constant {s}
  0.2,                       !- Rated Waste Heat Fraction of Power Input
  <%= system_name %> Cool-Waste,  !- Speed 1 Waste Heat Function of Temperature Curve Name
  ,                          !- Evaporative Condenser Effectiveness
  ,                          !- Evaporative Condenser Air Flow Rate {m^3/s}
    <% if comp_speeds < 4 %>
  ;                          !- Evaporative Condenser Pump Rated Power Consumption {W}
    <% else %>
  ,                          !- Evaporative Condenser Pump Rated Power Consumption {W}
  Autosize,                  !- Rated High Speed Total Cooling Capacity {W}
  Autosize,                  !- Rated High Speed Sensible Heat Ratio
  <%= cooling_coil_cop_4 %>, !- Rated High Speed COP
  Autosize,                  !- Rated High Speed Air Flow Rate {m^3/s}
  ,                          !- Rated Evaporator Fan Power Per Volume Flow Rate {W/(m^3/s)}
  <%= system_name %> Cool-Cap-fT4,  !- Total Cooling Capacity Function of Temperature Curve Name
  <%= system_name %> Cool-Cap-fFF4,  !- Total Cooling Capacity Function of Flow Fraction Curve Name
  <%= system_name %> Cool-EIR-fT4,  !- Energy Input Ratio Function of Temperature Curve Name
  <%= system_name %> Cool-EIR-fFF4,  !- Energy Input Ratio Function of Flow Fraction Curve Name
  <%= system_name %> Cool-PLF-fPLR4,  !- Part Load Fraction Correlation Curve Name
  1000,                      !- Nominal Time for Condensate Removal to Begin {s}
  1.5,                       !- Ratio of Initial Moisture Evaporation Rate and Steady State Latent Capacity
  3,                         !- Maximum Cycling Rate {cycles/hr}
  45,                        !- Latent Capacity Time Constant {s}
  0.2,                       !- Rated Waste Heat Fraction of Power Input
  <%= system_name %> Cool-Waste,  !- Speed 1 Waste Heat Function of Temperature Curve Name
  ,                          !- Evaporative Condenser Effectiveness
  ,                          !- Evaporative Condenser Air Flow Rate {m^3/s}
  ;                          !- Evaporative Condenser Pump Rated Power Consumption {W}
    <% end %>
  <% end %>

  <% if cooling_coil_type == "ASHP" and comp_speeds == 2 %>
! Following performance curves taken from two-speed ASHP system in BeOpt

Curve:Biquadratic,
   <%= system_name %> Cool-Cap-fT1,   !- Name
   1.658788451,-0.0834530076,0.00342409032,0.0024332436,-0.000045036,-0.00053367984,   !- Coefficients (list)
   13.88,          !- Minimum Value of x
   23.88,          !- Maximum Value of x
   18.33,          !- Minimum Value of y
   51.66;          !- Maximum Value of y

Curve:Biquadratic,
   <%= system_name %> Cool-EIR-fT1,   !- Name
   -0.5829157010000001,0.1581006726,-0.00439794684,-0.020335122,0.00107983368,-0.0006395922,   !- Coefficients (List)
   13.88,          !- Minimum Value of x
   23.88,          !- Maximum Value of x
   18.33,          !- Minimum Value of y
   51.66;          !- Maximum Value of y

Curve:Quadratic,
   <%= system_name %> Cool-PLF-fPLR1,   !- Name
   <%= 1 - cooling_coil_cd %>,<%= cooling_coil_cd %>,0,     !- Coefficients (List)
   0,               !- Minimum Value of x
   1,               !- Maximum Value of x
   0.7,             !- Minimum Value of y
   1;               !- Maximum Value of y

Curve:Quadratic,
   <%= system_name %> Cool-Cap-fFF1,  !- Name
   0.655239515,0.511655216,-0.166894731,   !- Coefficients (List)
   0,                                      !- Minimum Value of x
   2,                                      !- Maximum Value of x
   0,                                      !- Minimum Value of y
   2;                                      !- Maximum Value of y

Curve:Quadratic,
   <%= system_name %> Cool-EIR-fFF1,  !- Name
   1.639108268,-0.998953996,0.359845728,   !- Coefficients (List)
   0,                                      !- Minimum Value of x
   2,                                      !- Maximum Value of x
   0,                                      !- Minimum Value of y
   2;                                      !- Maximum Value of y

Curve:Biquadratic,
   <%= system_name %> Cool-Cap-fT2,   !- Name
   1.472738138,-0.0672218352,0.0029199042,0.0000516006,-0.0000297756,-0.00035908596,   !- Coefficients (list)
   13.88,          !- Minimum Value of x
   23.88,          !- Maximum Value of x
   18.33,          !- Minimum Value of y
   51.66;          !- Maximum Value of y

Curve:Biquadratic,
   <%= system_name %> Cool-EIR-fT2,   !- Name
   -0.4881955970000001,0.0991621818,-0.00236967444,0.019503441,0.0004297698,-0.00109743984,   !- Coefficients (List)
   13.88,          !- Minimum Value of x
   23.88,          !- Maximum Value of x
   18.33,          !- Minimum Value of y
   51.66;          !- Maximum Value of y

Curve:Quadratic,
   <%= system_name %> Cool-PLF-fPLR2,   !- Name
   <%= 1 - cooling_coil_cd %>,<%= cooling_coil_cd %>,0,     !- Coefficients (List)
   0,                !- Minimum Value of x
   1,                !- Maximum Value of x
   0.7,              !- Minimum Value of y
   1;                !- Maximum Value of y

Curve:Quadratic,
   <%= system_name %> Cool-Cap-fFF2,                          !- Name
   0.618281092,0.569060264,-0.187341356,   !- Coefficients (List)
   0,                                      !- Minimum Value of x
   2,                                      !- Maximum Value of x
   0,                                      !- Minimum Value of y
   2;                                      !- Maximum Value of y

Curve:Quadratic,
   <%= system_name %> Cool-EIR-fFF2,                          !- Name
   1.570774717,-0.914152018,0.343377302,   !- Coefficients (List)
   0,                                      !- Minimum Value of x
   2,                                      !- Maximum Value of x
   0,                                      !- Minimum Value of y
   2;                                      !- Maximum Value of y
  <% elsif cooling_coil_type == "DX" and comp_speeds == 2 %>
! Following performance curves taken from two-speed DX system in BeOpt

Curve:Biquadratic,
   <%= system_name %> Cool-Cap-fT1,   !- Name
   1.66457706,-0.0803905902,0.00330252552,0.001238751,-0.0000308772,-0.00052377192,   !- Coefficients (list)
   13.88,          !- Minimum Value of x
   23.88,          !- Maximum Value of x
   18.33,          !- Minimum Value of y
   51.66;          !- Maximum Value of y

Curve:Biquadratic,
   <%= system_name %> Cool-EIR-fT1,   !- Name
   -0.4273761999999997,0.1419060744,-0.0041237262,-0.0140625414,0.00083109888,-0.00043266636,   !- Coefficients (List)
   13.88,          !- Minimum Value of x
   23.88,          !- Maximum Value of x
   18.33,          !- Minimum Value of y
   51.66;          !- Maximum Value of y

Curve:Quadratic,
   <%= system_name %> Cool-PLF-fPLR1,   !- Name
   <%= 1 - cooling_coil_cd %>,<%= cooling_coil_cd %>,0,     !- Coefficients (List)
   0,                !- Minimum Value of x
   1,                !- Maximum Value of x
   0.7,              !- Minimum Value of y
   1;                !- Maximum Value of y

Curve:Quadratic,
   <%= system_name %> Cool-Cap-fFF1,                         !- Name
   0.65673024,0.516470835,-0.172887149,   !- Coefficients (List)
   0,                                     !- Minimum Value of x
   2,                                     !- Maximum Value of x
   0,                                     !- Minimum Value of y
   2;                                     !- Maximum Value of y

Curve:Quadratic,
   <%= system_name %> Cool-EIR-fFF1,                          !- Name
   1.562945114,-0.791859997,0.230030877,   !- Coefficients (List)
   0,                                      !- Minimum Value of x
   2,                                      !- Maximum Value of x
   0,                                      !- Minimum Value of y
   2;                                      !- Maximum Value of y

Curve:Biquadratic,
   <%= system_name %> Cool-Cap-fT2,   !- Name
   1.3678787110000001,-0.0625665258,0.00279689112,0.0050409684,-0.00006804,-0.00045420264,   !- Coefficients (list)
   13.88,          !- Minimum Value of x
   23.88,          !- Maximum Value of x
   18.33,          !- Minimum Value of y
   51.66;          !- Maximum Value of y

Curve:Biquadratic,
   <%= system_name %> Cool-EIR-fT2,   !- Name
   0.0423235170000003,0.0789200082,-0.002376054,-0.0030359106,0.00053492076,-0.000323028,   !- Coefficients (List)
   13.88,          !- Minimum Value of x
   23.88,          !- Maximum Value of x
   18.33,          !- Minimum Value of y
   51.66;          !- Maximum Value of y

Curve:Quadratic,
   <%= system_name %> Cool-PLF-fPLR2,   !- Name
   <%= 1 - cooling_coil_cd %>,<%= cooling_coil_cd %>,0,     !- Coefficients (List)
   0,                !- Minimum Value of x
   1,                !- Maximum Value of x
   0.7,              !- Minimum Value of y
   1;                !- Maximum Value of y

Curve:Quadratic,
   <%= system_name %> Cool-Cap-fFF2,                          !- Name
   0.690334551,0.464383753,-0.154507638,   !- Coefficients (List)
   0,                                      !- Minimum Value of x
   2,                                      !- Maximum Value of x
   0,                                      !- Minimum Value of y
   2;                                      !- Maximum Value of y

Curve:Quadratic,
   <%= system_name %> Cool-EIR-fFF2,                         !- Name
   1.31565404,-0.482467162,0.166239001,   !- Coefficients (List)
   0,                                     !- Minimum Value of x
   2,                                     !- Maximum Value of x
   0,                                     !- Minimum Value of y
   2;                                     !- Maximum Value of y
  <% elsif cooling_coil_type == "ASHP" and comp_speeds > 2 %>
    <% if ashp_type == "UNITARY" %>
! Following performance curves taken from four-speed ASHP system in BeOpt

Curve:Biquadratic,
   <%= system_name %> Cool-Cap-fT1,   !- Name
   1.7139851972,-0.0746167716,0.00297468936,0.00577633536,-0.000103131468,-0.00066888504,   !- Coefficients (list)
   13.88,          !- Minimum Value of x
   23.88,          !- Maximum Value of x
   18.33,          !- Minimum Value of y
   51.66;          !- Maximum Value of y

Curve:Biquadratic,
   <%= system_name %> Cool-EIR-fT1,   !- Name
   -0.0459238618,0.06829090668,-0.00219033396,-0.01723331952,0.00103872132,-0.000199631628,   !- Coefficients (List)
   13.88,          !- Minimum Value of x
   23.88,          !- Maximum Value of x
   18.33,          !- Minimum Value of y
   51.66;          !- Maximum Value of y

Curve:Quadratic,
   <%= system_name %> Cool-PLF-fPLR1,   !- Name
   <%= 1 - cooling_coil_cd %>,<%= cooling_coil_cd %>,0,     !- Coefficients (List)
   0,                !- Minimum Value of x
   1,                !- Maximum Value of x
   0.7,              !- Minimum Value of y
   1;                !- Maximum Value of y

Curve:Quadratic,
   <%= system_name %> Cool-Cap-fFF1,   !- Name
   1,0,0,           !- Coefficients (List)
   0,               !- Minimum Value of x
   2,               !- Maximum Value of x
   0,               !- Minimum Value of y
   2;               !- Maximum Value of y

Curve:Quadratic,
   <%= system_name %> Cool-EIR-fFF1,   !- Name
   1,0,0,           !- Coefficients (List)
   0,               !- Minimum Value of x
   2,               !- Maximum Value of x
   0,               !- Minimum Value of y
   2;               !- Maximum Value of y

Curve:Biquadratic,
   <%= system_name %> Cool-Cap-fT2,   !- Name
   1.15285674,-0.0245373048,0.00176665212,0.0058603014,-0.00007723512,-0.00066472488,   !- Coefficients (list)
   13.88,          !- Minimum Value of x
   23.88,          !- Maximum Value of x
   18.33,          !- Minimum Value of y
   51.66;          !- Maximum Value of y

Curve:Biquadratic,
   <%= system_name %> Cool-EIR-fT2,   !- Name
   1.7046091386,-0.10488220416,0.00218213676,-0.01672851276,0.000954018,-0.000126467244,   !- Coefficients (List)
   13.88,          !- Minimum Value of x
   23.88,          !- Maximum Value of x
   18.33,          !- Minimum Value of y
   51.66;          !- Maximum Value of y

Curve:Quadratic,
   <%= system_name %> Cool-PLF-fPLR2,   !- Name
   <%= 1 - cooling_coil_cd %>,<%= cooling_coil_cd %>,0,     !- Coefficients (List)
   0,                !- Minimum Value of x
   1,                !- Maximum Value of x
   0.7,              !- Minimum Value of y
   1;                !- Maximum Value of y

Curve:Quadratic,
   <%= system_name %> Cool-Cap-fFF2,   !- Name
   1,0,0,           !- Coefficients (List)
   0,               !- Minimum Value of x
   2,               !- Maximum Value of x
   0,               !- Minimum Value of y
   2;               !- Maximum Value of y

Curve:Quadratic,
   <%= system_name %> Cool-EIR-fFF2,   !- Name
   1,0,0,           !- Coefficients (List)
   0,               !- Minimum Value of x
   2,               !- Maximum Value of x
   0,               !- Minimum Value of y
   2;               !- Maximum Value of y

Curve:Biquadratic,
   <%= system_name %> Cool-Cap-fT3,   !- Name
   0.6461992122,0.0213513228,0.00065910348,0.00693808596,-0.000067378068,-0.00068810796,   !- Coefficients (list)
   13.88,          !- Minimum Value of x
   23.88,          !- Maximum Value of x
   18.33,          !- Minimum Value of y
   51.66;          !- Maximum Value of y

Curve:Biquadratic,
   <%= system_name %> Cool-EIR-fT3,   !- Name
   -0.0062540160000003,0.0463319604,-0.00142349076,0.0118725714,0.00048109464,-0.00051695172,   !- Coefficients (List)
   13.88,          !- Minimum Value of x
   23.88,          !- Maximum Value of x
   18.33,          !- Minimum Value of y
   51.66;          !- Maximum Value of y

Curve:Quadratic,
   <%= system_name %> Cool-PLF-fPLR3,   !- Name
   <%= 1 - cooling_coil_cd %>,<%= cooling_coil_cd %>,0,     !- Coefficients (List)
   0,                !- Minimum Value of x
   1,                !- Maximum Value of x
   0.7,              !- Minimum Value of y
   1;                !- Maximum Value of y

Curve:Quadratic,
   <%= system_name %> Cool-Cap-fFF3,   !- Name
   1,0,0,           !- Coefficients (List)
   0,               !- Minimum Value of x
   2,               !- Maximum Value of x
   0,               !- Minimum Value of y
   2;               !- Maximum Value of y

Curve:Quadratic,
   <%= system_name %> Cool-EIR-fFF3,   !- Name
   1,0,0,           !- Coefficients (List)
   0,               !- Minimum Value of x
   2,               !- Maximum Value of x
   0,               !- Minimum Value of y
   2;               !- Maximum Value of y

Curve:Biquadratic,
   <%= system_name %> Cool-Cap-fT4,   !- Name
   0.9177891678000001,-0.0060322572,0.00136327212,0.00532574064,-0.000056581092,-0.00063857808,   !- Coefficients (list)
   13.88,          !- Minimum Value of x
   23.88,          !- Maximum Value of x
   18.33,          !- Minimum Value of y
   51.66;          !- Maximum Value of y

Curve:Biquadratic,
   <%= system_name %> Cool-EIR-fT4,   !- Name
   -0.5184327770000003,0.0992787624,-0.00276048324,0.013988232,0.00043519356,-0.00055720224,   !- Coefficients (List)
   13.88,          !- Minimum Value of x
   23.88,          !- Maximum Value of x
   18.33,          !- Minimum Value of y
   51.66;          !- Maximum Value of y

Curve:Quadratic,
   <%= system_name %> Cool-PLF-fPLR4,   !- Name
   <%= 1 - cooling_coil_cd %>,<%= cooling_coil_cd %>,0,     !- Coefficients (List)
   0,                !- Minimum Value of x
   1,                !- Maximum Value of x
   0.7,              !- Minimum Value of y
   1;                !- Maximum Value of y

Curve:Quadratic,
   <%= system_name %> Cool-Cap-fFF4,   !- Name
   1,0,0,           !- Coefficients (List)
   0,               !- Minimum Value of x
   2,               !- Maximum Value of x
   0,               !- Minimum Value of y
   2;               !- Maximum Value of y

Curve:Quadratic,
   <%= system_name %> Cool-EIR-fFF4,   !- Name
   1,0,0,           !- Coefficients (List)
   0,               !- Minimum Value of x
   2,               !- Maximum Value of x
   0,               !- Minimum Value of y
   2;               !- Maximum Value of y
    <% elsif ashp_type == "MINISPLIT" %>
! Following performance curves taken from four-speed Minisplit Heat Pump system in BeOpt (based on Fujitsu 12RLS minisplit unit testing in NREL report at http://www.nrel.gov/docs/fy11osti/52175.pdf)

Curve:Biquadratic,
   <%= system_name %> Cool-Cap-fT1,   !- Name
   1.008993521905866,0.006512749025457,0,0.003917565735935,-0.000222646705889,0,   !- Coefficients (list)
   13.88,          !- Minimum Value of x
   23.88,          !- Maximum Value of x
   18.33,          !- Minimum Value of y
   51.66;          !- Maximum Value of y

Curve:Biquadratic,
   <%= system_name %> Cool-EIR-fT1,   !- Name
   0.429214441601141,-0.003604841598515,0.000045783162727,0.026490875804937,-0.000159212286878,-0.000159062656483,   !- Coefficients (List)
   13.88,          !- Minimum Value of x
   23.88,          !- Maximum Value of x
   18.33,          !- Minimum Value of y
   51.66;          !- Maximum Value of y

Curve:Quadratic,
   <%= system_name %> Cool-PLF-fPLR1,   !- Name
   <%= 1 - cooling_coil_cd %>,<%= cooling_coil_cd %>,0,     !- Coefficients (List)
   0,                !- Minimum Value of x
   1,                !- Maximum Value of x
   0.7,              !- Minimum Value of y
   1;                !- Maximum Value of y

Curve:Quadratic,
   <%= system_name %> Cool-Cap-fFF1,   !- Name
   1,0,0,           !- Coefficients (List)
   0,               !- Minimum Value of x
   2,               !- Maximum Value of x
   0,               !- Minimum Value of y
   2;               !- Maximum Value of y

Curve:Quadratic,
   <%= system_name %> Cool-EIR-fFF1,   !- Name
   1,0,0,           !- Coefficients (List)
   0,               !- Minimum Value of x
   2,               !- Maximum Value of x
   0,               !- Minimum Value of y
   2;               !- Maximum Value of y

Curve:Biquadratic,
   <%= system_name %> Cool-Cap-fT2,   !- Name
   1.008993521905866,0.006512749025457,0,0.003917565735935,-0.000222646705889,0,   !- Coefficients (list)
   13.88,          !- Minimum Value of x
   23.88,          !- Maximum Value of x
   18.33,          !- Minimum Value of y
   51.66;          !- Maximum Value of y

Curve:Biquadratic,
   <%= system_name %> Cool-EIR-fT2,   !- Name
   0.429214441601141,-0.003604841598515,0.000045783162727,0.026490875804937,-0.000159212286878,-0.000159062656483,   !- Coefficients (List)
   13.88,          !- Minimum Value of x
   23.88,          !- Maximum Value of x
   18.33,          !- Minimum Value of y
   51.66;          !- Maximum Value of y

Curve:Quadratic,
   <%= system_name %> Cool-PLF-fPLR2,   !- Name
   <%= 1 - cooling_coil_cd %>,<%= cooling_coil_cd %>,0,     !- Coefficients (List)
   0,                !- Minimum Value of x
   1,                !- Maximum Value of x
   0.7,              !- Minimum Value of y
   1;                !- Maximum Value of y

Curve:Quadratic,
   <%= system_name %> Cool-Cap-fFF2,   !- Name
   1,0,0,           !- Coefficients (List)
   0,               !- Minimum Value of x
   2,               !- Maximum Value of x
   0,               !- Minimum Value of y
   2;               !- Maximum Value of y

Curve:Quadratic,
   <%= system_name %> Cool-EIR-fFF2,   !- Name
   1,0,0,           !- Coefficients (List)
   0,               !- Minimum Value of x
   2,               !- Maximum Value of x
   0,               !- Minimum Value of y
   2;               !- Maximum Value of y

Curve:Biquadratic,
   <%= system_name %> Cool-Cap-fT3,   !- Name
   1.008993521905866,0.006512749025457,0,0.003917565735935,-0.000222646705889,0,   !- Coefficients (list)
   13.88,          !- Minimum Value of x
   23.88,          !- Maximum Value of x
   18.33,          !- Minimum Value of y
   51.66;          !- Maximum Value of y

Curve:Biquadratic,
   <%= system_name %> Cool-EIR-fT3,   !- Name
   0.429214441601141,-0.003604841598515,0.000045783162727,0.026490875804937,-0.000159212286878,-0.000159062656483,   !- Coefficients (List)
   13.88,          !- Minimum Value of x
   23.88,          !- Maximum Value of x
   18.33,          !- Minimum Value of y
   51.66;          !- Maximum Value of y

Curve:Quadratic,
   <%= system_name %> Cool-PLF-fPLR3,   !- Name
   <%= 1 - cooling_coil_cd %>,<%= cooling_coil_cd %>,0,     !- Coefficients (List)
   0,                !- Minimum Value of x
   1,                !- Maximum Value of x
   0.7,              !- Minimum Value of y
   1;                !- Maximum Value of y

Curve:Quadratic,
   <%= system_name %> Cool-Cap-fFF3,   !- Name
   1,0,0,           !- Coefficients (List)
   0,               !- Minimum Value of x
   2,               !- Maximum Value of x
   0,               !- Minimum Value of y
   2;               !- Maximum Value of y

Curve:Quadratic,
   <%= system_name %> Cool-EIR-fFF3,   !- Name
   1,0,0,           !- Coefficients (List)
   0,               !- Minimum Value of x
   2,               !- Maximum Value of x
   0,               !- Minimum Value of y
   2;               !- Maximum Value of y

Curve:Biquadratic,
   <%= system_name %> Cool-Cap-fT4,   !- Name
   1.008993521905866,0.006512749025457,0,0.003917565735935,-0.000222646705889,0,   !- Coefficients (list)
   13.88,          !- Minimum Value of x
   23.88,          !- Maximum Value of x
   18.33,          !- Minimum Value of y
   51.66;          !- Maximum Value of y

Curve:Biquadratic,
   <%= system_name %> Cool-EIR-fT4,   !- Name
   0.429214441601141,-0.003604841598515,0.000045783162727,0.026490875804937,-0.000159212286878,-0.000159062656483,   !- Coefficients (List)
   13.88,          !- Minimum Value of x
   23.88,          !- Maximum Value of x
   18.33,          !- Minimum Value of y
   51.66;          !- Maximum Value of y

Curve:Quadratic,
   <%= system_name %> Cool-PLF-fPLR4,   !- Name
   <%= 1 - cooling_coil_cd %>,<%= cooling_coil_cd %>,0,     !- Coefficients (List)
   0,                !- Minimum Value of x
   1,                !- Maximum Value of x
   0.7,              !- Minimum Value of y
   1;                !- Maximum Value of y

Curve:Quadratic,
   <%= system_name %> Cool-Cap-fFF4,   !- Name
   1,0,0,           !- Coefficients (List)
   0,               !- Minimum Value of x
   2,               !- Maximum Value of x
   0,               !- Minimum Value of y
   2;               !- Maximum Value of y

Curve:Quadratic,
   <%= system_name %> Cool-EIR-fFF4,   !- Name
   1,0,0,           !- Coefficients (List)
   0,               !- Minimum Value of x
   2,               !- Maximum Value of x
   0,               !- Minimum Value of y
   2;               !- Maximum Value of y
    <% end %>
  <% elsif cooling_coil_type == "DX" and comp_speeds > 2 %>
! Following performance curves taken from four-speed DX system in BeOpt

Curve:Biquadratic,
   <%= system_name %> Cool-Cap-fT1,   !- Name
   1.790226088881,-0.0772146982404,0.00299548780452,0.0026270330994,-0.0000681238188,-0.00062105857056,   !- Coefficients (list)
   13.88,          !- Minimum Value of x
   23.88,          !- Maximum Value of x
   18.33,          !- Minimum Value of y
   51.66;          !- Maximum Value of y

Curve:Biquadratic,
   <%= system_name %> Cool-EIR-fT1,   !- Name
   -0.1450569951999998,0.062239559472,-0.00190953288,-0.012608055432,0.0010591834752,-0.0003311985672,   !- Coefficients (List)
   13.88,          !- Minimum Value of x
   23.88,          !- Maximum Value of x
   18.33,          !- Minimum Value of y
   51.66;          !- Maximum Value of y

Curve:Quadratic,
   <%= system_name %> Cool-PLF-fPLR1,   !- Name
   <%= 1 - cooling_coil_cd %>,<%= cooling_coil_cd %>,0,     !- Coefficients (List)
   0,                !- Minimum Value of x
   1,                !- Maximum Value of x
   0.7,              !- Minimum Value of y
   1;                !- Maximum Value of y

Curve:Quadratic,
   <%= system_name %> Cool-Cap-fFF1,   !- Name
   1,0,0,           !- Coefficients (List)
   0,               !- Minimum Value of x
   2,               !- Maximum Value of x
   0,               !- Minimum Value of y
   2;               !- Maximum Value of y

Curve:Quadratic,
   <%= system_name %> Cool-EIR-fFF1,   !- Name
   1,0,0,           !- Coefficients (List)
   0,               !- Minimum Value of x
   2,               !- Maximum Value of x
   0,               !- Minimum Value of y
   2;               !- Maximum Value of y

Curve:Biquadratic,
   <%= system_name %> Cool-Cap-fT2,   !- Name
   1.189356223401,-0.0251898606522,0.0018013099626,0.004151872233,-0.00004332993588,-0.0006851085138,   !- Coefficients (list)
   13.88,          !- Minimum Value of x
   23.88,          !- Maximum Value of x
   18.33,          !- Minimum Value of y
   51.66;          !- Maximum Value of y

Curve:Biquadratic,
   <%= system_name %> Cool-EIR-fT2,   !- Name
   1.21042990764,-0.076844452176,0.00151658244,-0.002526115752,0.0007214803488,-0.0001603816524,   !- Coefficients (List)
   13.88,          !- Minimum Value of x
   23.88,          !- Maximum Value of x
   18.33,          !- Minimum Value of y
   51.66;          !- Maximum Value of y

Curve:Quadratic,
   <%= system_name %> Cool-PLF-fPLR2,   !- Name
   <%= 1 - cooling_coil_cd %>,<%= cooling_coil_cd %>,0,     !- Coefficients (List)
   0,                !- Minimum Value of x
   1,                !- Maximum Value of x
   0.7,              !- Minimum Value of y
   1;                !- Maximum Value of y

Curve:Quadratic,
   <%= system_name %> Cool-Cap-fFF2,   !- Name
   1,0,0,           !- Coefficients (List)
   0,               !- Minimum Value of x
   2,               !- Maximum Value of x
   0,               !- Minimum Value of y
   2;               !- Maximum Value of y

Curve:Quadratic,
   <%= system_name %> Cool-EIR-fFF2,   !- Name
   1,0,0,           !- Coefficients (List)
   0,               !- Minimum Value of x
   2,               !- Maximum Value of x
   0,               !- Minimum Value of y
   2;               !- Maximum Value of y

Curve:Biquadratic,
   <%= system_name %> Cool-Cap-fT3,   !- Name
   -0.3002163257220003,0.1194562230534,-0.001862843184,0.0007302272778,-0.00003753475524,-0.00043911348696,   !- Coefficients (list)
   13.88,          !- Minimum Value of x
   23.88,          !- Maximum Value of x
   18.33,          !- Minimum Value of y
   51.66;          !- Maximum Value of y

Curve:Biquadratic,
   <%= system_name %> Cool-EIR-fT3,   !- Name
   0.7018306454800002,-0.049235917464,0.00126482472,0.031408426368,0.0003622673484,-0.0011050729236,   !- Coefficients (List)
   13.88,          !- Minimum Value of x
   23.88,          !- Maximum Value of x
   18.33,          !- Minimum Value of y
   51.66;          !- Maximum Value of y

Curve:Quadratic,
   <%= system_name %> Cool-PLF-fPLR3,   !- Name
   <%= 1 - cooling_coil_cd %>,<%= cooling_coil_cd %>,0,     !- Coefficients (List)
   0,                !- Minimum Value of x
   1,                !- Maximum Value of x
   0.7,              !- Minimum Value of y
   1;                !- Maximum Value of y

Curve:Quadratic,
   <%= system_name %> Cool-Cap-fFF3,   !- Name
   1,0,0,           !- Coefficients (List)
   0,               !- Minimum Value of x
   2,               !- Maximum Value of x
   0,               !- Minimum Value of y
   2;               !- Maximum Value of y

Curve:Quadratic,
   <%= system_name %> Cool-EIR-fFF3,   !- Name
   1,0,0,           !- Coefficients (List)
   0,               !- Minimum Value of x
   2,               !- Maximum Value of x
   0,               !- Minimum Value of y
   2;               !- Maximum Value of y

Curve:Biquadratic,
   <%= system_name %> Cool-Cap-fT4,   !- Name
   0.9622498807840001,-0.0039087090378,0.00132934689648,0.0016072565382,-0.00000008342352,-0.00065486142576,   !- Coefficients (list)
   13.88,          !- Minimum Value of x
   23.88,          !- Maximum Value of x
   18.33,          !- Minimum Value of y
   51.66;          !- Maximum Value of y

Curve:Biquadratic,
   <%= system_name %> Cool-EIR-fT4,   !- Name
   -0.7479878260800004,0.099914996016,-0.00272789532,0.026966547,0.0002513297808,-0.0006019728516,   !- Coefficients (List)
   13.88,          !- Minimum Value of x
   23.88,          !- Maximum Value of x
   18.33,          !- Minimum Value of y
   51.66;          !- Maximum Value of y

Curve:Quadratic,
   <%= system_name %> Cool-PLF-fPLR4,   !- Name
   <%= 1 - cooling_coil_cd %>,<%= cooling_coil_cd %>,0,     !- Coefficients (List)
   0,                !- Minimum Value of x
   1,                !- Maximum Value of x
   0.7,              !- Minimum Value of y
   1;                !- Maximum Value of y

Curve:Quadratic,
   <%= system_name %> Cool-Cap-fFF4,   !- Name
   1,0,0,           !- Coefficients (List)
   0,               !- Minimum Value of x
   2,               !- Maximum Value of x
   0,               !- Minimum Value of y
   2;               !- Maximum Value of y

Curve:Quadratic,
   <%= system_name %> Cool-EIR-fFF4,   !- Name
   1,0,0,           !- Coefficients (List)
   0,               !- Minimum Value of x
   2,               !- Maximum Value of x
   0,               !- Minimum Value of y
   2;               !- Maximum Value of y
  <% end %>

Curve:Biquadratic,
  <%= system_name %> Cool-Waste,         !- Name
  1,0,0,0,0,0,   !- Coefficients (List)
  -100,               !- Minimum Value of x
  100,                !- Maximum Value of x
  -100,               !- Minimum Value of y
  100;                !- Maximum Value of y

<% elsif (cooling_coil_type == "WSHP") %>

Coil:Cooling:WaterToAirHeatPump:EquationFit,
  <%= system_name %> Cooling Coil,  !- Name
  <%= system_name %> Water Source Inlet Node,  !- Water Inlet Node Name
  <%= system_name %> Water Source Intermediate Node,  !- Water Outlet Node Name
  <%= system_name %> Supply Fan Outlet Node,  !- Air Inlet Node Name
  <%= system_name %> Cooling Coil Outlet Node,  !- Air Outlet Node Name
  Autosize,                !- Rated Air Flow Rate {m3/s}
  Autosize,                !- Rated Water Flow Rate {m3/s}
  Autosize,                !- Gross Rated Total Cooling Capacity {W}
  Autosize,                !- Gross Rated Sensible Cooling Capacity {W}
  <%= cooling_coil_cop %>, !- Gross Rated Cooling COP
  -3.9160645385999993,                               !- Cooling Capacity Coefficient 1
  7.0429440240000005,                                !- Cooling Capacity Coefficient 2
  -2.2705893720000003,                               !- Cooling Capacity Coefficient 3
  0,                                                 !- Cooling Capacity Coefficient 4
  0,                                                 !- Cooling Capacity Coefficient 5
  26.7839398084,                                     !- Sensible Cooling Capacity Coefficient 1
  0,                                                 !- Sensible Cooling Capacity Coefficient 2
  -23.832385974,                                     !- Sensible Cooling Capacity Coefficient 3
  -1.115743914,                                      !- Sensible Cooling Capacity Coefficient 4
  0,                                                 !- Sensible Cooling Capacity Coefficient 5
  0,                                                 !- Sensible Cooling Capacity Coefficient 6
  -6.2337364523,                                     !- Cooling Power Consumption Coefficient 1
  1.610096238,                                       !- Cooling Power Consumption Coefficient 2
  5.317076448,                                       !- Cooling Power Consumption Coefficient 3
  0,                                                 !- Cooling Power Consumption Coefficient 4
  0,                                                 !- Cooling Power Consumption Coefficient 5
  1000,                                              !- Nominal Time for Condensate Removal to Begin {s}
  1.5;                                               !- Ratio of Initial Moisture Evaporation Rate and Steady State Latent Capacity {dimensionless}


<% end %>

<%
if (cooling_coil_type == "NONE")

  heating_coil_inlet_node = system_name + " Supply Fan Outlet Node"

elsif (cooling_coil_type == "DX" and comp_speeds > 1)

  heating_coil_inlet_node = system_name + " Dummy Heating Coil Outlet Node"

else

  heating_coil_inlet_node = system_name + " Cooling Coil Outlet Node"

end

%>

<% if (heating_coil_type == "GAS") %>

Coil:Heating:Fuel,
  <%= system_name %> Heating Coil,  !- Name
  <%= system_name %> Operation Schedule,  !- Availability Schedule Name
  NaturalGas,               !- Fuel Type
  <%= heating_coil_eff %>,  !- Gas Burner Efficiency
  <%= heating_coil_cap %>, !- Nominal Capacity {W}
  <%= heating_coil_inlet_node %>, !- Air Inlet Node Name
  <%= system_name %> Supply Equipment Outlet Node;  !- Air Outlet Node Name

<% elsif (heating_coil_type == "ELECTRIC") %>

Coil:Heating:Electric,
  <%= system_name %> Heating Coil,  !- Name
  <%= system_name %> Operation Schedule,  !- Availability Schedule Name
  <%= heating_coil_eff %>,  !- Efficiency
  <%= heating_coil_cap %>, !- Nominal Capacity {W}
  <%= heating_coil_inlet_node %>, !- Air Inlet Node Name
  <%= system_name %> Supply Equipment Outlet Node;  !- Air Outlet Node Name

<% elsif (heating_coil_type == "ASHP") %>
  <% if (comp_speeds == 1) %>

Coil:Heating:DX:SingleSpeed,
  <%= system_name %> Heating Coil,  !- Name
  <%= system_name %> Operation Schedule,  !- Availability Schedule Name
  <%= heating_coil_cap %>,        !- Rated Total Heating Capacity {W}
  <%= heating_coil_eff %>,        !- Rated COP
  <%= fan_flow_supply %>,         !- Rated Air Flow Rate {m^3/s}
  ,                               !- Rated Evaporator Fan Power Per Volume Flow Rate {W/(m/s)}
  <%= heating_coil_inlet_node %>, !- Air Inlet Node Name
  <%= system_name %> Heating Coil Outlet Node,  !- Air Outlet Node Name
  <%= system_name %> HP_Heat-Cap-fT,  !- Total Heating Capacity Function of Temperature Curve Name
  <%= system_name %> HP_Heat-Cap-fFF,  !- Total Heating Capacity Function of Flow Fraction Curve Name
  <%= system_name %> HP_Heat-EIR-fT,  !- Energy Input Ratio Function of Temperature Curve Name
  <%= system_name %> HP_Heat-EIR-fFF,  !- Energy Input Ratio Function of Flow Fraction Curve Name
  <%= system_name %> HP_Heat-PLF-fPLR,  !- Part Load Fraction Correlation Curve Name
  <%= system_name %> DefrostEIR,  !- Defrost Energy Input Ratio Function of Temperature Curve Name
  <%= hp_min_temp %>,             !- Minimum Outdoor Dry-Bulb Temperature for Compressor Operation {C}
  ,                               !- Outdoor Dry-Bulb Temperature to Turn On Compressor {C}
  <%= hp_defrost_temp %>,         !- Maximum Outdoor Dry-Bulb Temperature for Defrost Operation {C}
  <%= crankcase_cap %>,           !- Crankcase Heater Capacity {W}
  <%= crankcase_max_temp %>,      !- Maximum Outdoor Dry-Bulb Temperature for Crankcase Heater Operation {C}
  ReverseCycle,                   !- Defrost Strategy
  Timed,                          !- Defrost Control
  0.0;                       !- Defrost Time Period Fraction

! Following performance curves taken from single-speed ASHP system in BeOpt
Curve:Biquadratic,
  <%= system_name %> HP_Heat-Cap-fT,   !- Name
  0.878143655,-0.0029148552,-0.000033372,0.0223866612,0.000163944,-0.00002187,   !- Coefficients (list)
  -100,             !- Minimum Value of x
  100,              !- Maximum Value of x
  -100,             !- Minimum Value of y
  100;              !- Maximum Value of y

Curve:Biquadratic,
  <%= system_name %> HP_Heat-EIR-fT,   !- Name
  0.716518071,0.0102759012,0.00046073448,-0.0064803654,0.000456354,-0.00069764004,   !- Coefficients (List)
  -100,             !- Minimum Value of x
  100,              !- Maximum Value of x
  -100,             !- Minimum Value of y
  100;              !- Maximum Value of y

Curve:Quadratic,
  <%= system_name %> HP_Heat-PLF-fPLR,   !- Name
  <%= 1 - heating_coil_cd %>,<%= heating_coil_cd %>,0,     !- Coefficients (List)
  0,                  !- Minimum Value of x
  1,                  !- Maximum Value of x
  0.7,                !- Minimum Value of y
  1;                  !- Maximum Value of y

Curve:Quadratic,
  <%= system_name %> HP_Heat-Cap-fFF,                        !- Name
  0.694045465,0.474207981,-0.168253446,   !- Coefficients (List)
  0,                                      !- Minimum Value of x
  2,                                      !- Maximum Value of x
  0,                                      !- Minimum Value of y
  2;                                      !- Maximum Value of y

Curve:Quadratic,
  <%= system_name %> HP_Heat-EIR-fFF,                        !- Name
  2.185418751,-1.942827919,0.757409168,   !- Coefficients (List)
  0,                                      !- Minimum Value of x
  2,                                      !- Maximum Value of x
  0,                                      !- Minimum Value of y
  2;                                      !- Maximum Value of y

Curve:Biquadratic,
  <%= system_name %> DefrostEIR,         !- Name
  0.1528,0,0,0,0,0,   !- Coefficients (List)
  -100,               !- Minimum Value of x
  100,                !- Maximum Value of x
  -100,               !- Minimum Value of y
  100;                !- Maximum Value of y

  <% else %>

Coil:Heating:DX:MultiSpeed,
  <%= system_name %> Heating Coil,  !- Name
  <%= system_name %> Operation Schedule,  !- Availability Schedule Name
  <%= heating_coil_inlet_node %>, !- Air Inlet Node Name
  <%= system_name %> Heating Coil Outlet Node,  !- Air Outlet Node Name
  <%= hp_min_temp %>,             !- Minimum Outdoor Dry-Bulb Temperature for Compressor Operation {C}
  ,                               !- Outdoor Dry-Bulb Temperature to Turn On Compressor {C}
  <%= crankcase_cap %>,           !- Crankcase Heater Capacity {W}
  <%= crankcase_max_temp %>,      !- Maximum Outdoor Dry-Bulb Temperature for Crankcase Heater Operation {C}
  <%= system_name %> DefrostEIR,  !- Defrost Energy Input Ratio Function of Temperature Curve Name
  <%= hp_defrost_temp %>,         !- Maximum Outdoor Dry-Bulb Temperature for Defrost Operation {C}
  ReverseCycle,                   !- Defrost Strategy
  Timed,                          !- Defrost Control
  0.0,                            !- Defrost Time Period Fraction
  ,                               !- Resistive Defrost Heater Capacity {W}
  No,                             !- Apply Part Load Fraction to Speeds Greater than 1
  Electricity,                    !- Fuel Type
  ,                               !- Region number for Calculating HSPF
  <%= comp_speeds %>,             !- Number of Speeds
  <%= heating_coil_cap %>,        !- Rated Total Heating Capacity {W}
  <%= heating_coil_eff %>,     !- Rated COP
  <%= fan_flow_supply %>,         !- Rated Air Flow Rate {m^3/s}
  ,                               !- Rated Evaporator Fan Power Per Volume Flow Rate {W/(m/s)}
  <%= system_name %> HP_Heat-Cap-fT1,  !- Total Heating Capacity Function of Temperature Curve Name
  <%= system_name %> HP_Heat-Cap-fFF1,  !- Total Heating Capacity Function of Flow Fraction Curve Name
  <%= system_name %> HP_Heat-EIR-fT1,  !- Energy Input Ratio Function of Temperature Curve Name
  <%= system_name %> HP_Heat-EIR-fFF1,  !- Energy Input Ratio Function of Flow Fraction Curve Name
  <%= system_name %> HP_Heat-PLF-fPLR1,  !- Part Load Fraction Correlation Curve Name
  0.2,                            !- Rated Waste Heat Fraction of Power Input
  <%= system_name %> HP_Heat-Waste,  !- Waste Heat Function of Temperature Curve Name
  Autosize,                       !- Rated Total Heating Capacity {W}
  <%= heating_coil_eff_2 %>,     !- Rated COP
  Autosize,                       !- Rated Air Flow Rate {m^3/s}
  ,                               !- Rated Evaporator Fan Power Per Volume Flow Rate {W/(m/s)}
  <%= system_name %> HP_Heat-Cap-fT2,  !- Total Heating Capacity Function of Temperature Curve Name
  <%= system_name %> HP_Heat-Cap-fFF2,  !- Total Heating Capacity Function of Flow Fraction Curve Name
  <%= system_name %> HP_Heat-EIR-fT2,  !- Energy Input Ratio Function of Temperature Curve Name
  <%= system_name %> HP_Heat-EIR-fFF2,  !- Energy Input Ratio Function of Flow Fraction Curve Name
  <%= system_name %> HP_Heat-PLF-fPLR2,  !- Part Load Fraction Correlation Curve Name
  0.2,                            !- Rated Waste Heat Fraction of Power Input
    <% if comp_speeds < 3 %>
  <%= system_name %> HP_Heat-Waste;  !- Waste Heat Function of Temperature Curve Name
    <% else %>
  <%= system_name %> HP_Heat-Waste,  !- Waste Heat Function of Temperature Curve Name
  Autosize,                       !- Rated Total Heating Capacity {W}
  <%= heating_coil_eff_3 %>,     !- Rated COP
  Autosize,                       !- Rated Air Flow Rate {m^3/s}
  ,                               !- Rated Evaporator Fan Power Per Volume Flow Rate {W/(m/s)}
  <%= system_name %> HP_Heat-Cap-fT3,  !- Total Heating Capacity Function of Temperature Curve Name
  <%= system_name %> HP_Heat-Cap-fFF3,  !- Total Heating Capacity Function of Flow Fraction Curve Name
  <%= system_name %> HP_Heat-EIR-fT3,  !- Energy Input Ratio Function of Temperature Curve Name
  <%= system_name %> HP_Heat-EIR-fFF3,  !- Energy Input Ratio Function of Flow Fraction Curve Name
  <%= system_name %> HP_Heat-PLF-fPLR3,  !- Part Load Fraction Correlation Curve Name
  0.2,                            !- Rated Waste Heat Fraction of Power Input
      <% if comp_speeds < 4 %>
  <%= system_name %> HP_Heat-Waste;  !- Waste Heat Function of Temperature Curve Name
      <% else %>
  <%= system_name %> HP_Heat-Waste,  !- Waste Heat Function of Temperature Curve Name
  Autosize,                       !- Rated Total Heating Capacity {W}
  <%= heating_coil_eff_4 %>,     !- Rated COP
  Autosize,                       !- Rated Air Flow Rate {m^3/s}
  ,                               !- Rated Evaporator Fan Power Per Volume Flow Rate {W/(m/s)}
  <%= system_name %> HP_Heat-Cap-fT4,  !- Total Heating Capacity Function of Temperature Curve Name
  <%= system_name %> HP_Heat-Cap-fFF4,  !- Total Heating Capacity Function of Flow Fraction Curve Name
  <%= system_name %> HP_Heat-EIR-fT4,  !- Energy Input Ratio Function of Temperature Curve Name
  <%= system_name %> HP_Heat-EIR-fFF4,  !- Energy Input Ratio Function of Flow Fraction Curve Name
  <%= system_name %> HP_Heat-PLF-fPLR4,  !- Part Load Fraction Correlation Curve Name
  0.2,                            !- Rated Waste Heat Fraction of Power Input
  <%= system_name %> HP_Heat-Waste;  !- Waste Heat Function of Temperature Curve Name
      <% end %>
    <% end %>

    <% if comp_speeds == 2 %>
! Following performance curves taken from two-speed ASHP system in BeOpt

Curve:Biquadratic,
  <%= system_name %> HP_Heat-Cap-fT1,   !- Name
  0.84077409,-0.0014336586,-0.000150336,0.029628603,0.000161676,-0.00002349,   !- Coefficients (list)
  -100,             !- Minimum Value of x
  100,              !- Maximum Value of x
  -100,             !- Minimum Value of y
  100;              !- Maximum Value of y

Curve:Biquadratic,
  <%= system_name %> HP_Heat-EIR-fT1,   !- Name
  0.539472334,0.0165103146,0.00083874528,-0.0040323402,0.00142404156,-0.00211806252,   !- Coefficients (List)
  -100,             !- Minimum Value of x
  100,              !- Maximum Value of x
  -100,             !- Minimum Value of y
  100;              !- Maximum Value of y

Curve:Quadratic,
  <%= system_name %> HP_Heat-PLF-fPLR1,   !- Name
  <%= 1 - heating_coil_cd %>,<%= heating_coil_cd %>,0,     !- Coefficients (List)
  0,                  !- Minimum Value of x
  1,                  !- Maximum Value of x
  0.7,                !- Minimum Value of y
  1;                  !- Maximum Value of y

Curve:Quadratic,
  <%= system_name %> HP_Heat-Cap-fFF1,                        !- Name
  0.741466907,0.378645444,-0.119754733,   !- Coefficients (List)
  0,                                      !- Minimum Value of x
  2,                                      !- Maximum Value of x
  0,                                      !- Minimum Value of y
  2;                                      !- Maximum Value of y

Curve:Quadratic,
  <%= system_name %> HP_Heat-EIR-fFF1,                        !- Name
  2.153618211,-1.737190609,0.584269478,   !- Coefficients (List)
  0,                                      !- Minimum Value of x
  2,                                      !- Maximum Value of x
  0,                                      !- Minimum Value of y
  2;                                      !- Maximum Value of y

Curve:Biquadratic,
   <%= system_name %> HP_Heat-Cap-fT2,   !- Name
   0.831506971,0.0018392166,-0.000187596,0.0266002056,0.000191484,-0.000065772,   !- Coefficients (list)
   -100,              !- Minimum Value of x
   100,               !- Maximum Value of x
   -100,              !- Minimum Value of y
   100;               !- Maximum Value of y

Curve:Biquadratic,
   <%= system_name %> HP_Heat-EIR-fT2,   !- Name
   0.787746797,-0.0006523146,0.00078866784,-0.0023209056,0.00074760408,-0.00109173096,   !- Coefficients (List)
   -100,              !- Minimum Value of x
   100,               !- Maximum Value of x
   -100,              !- Minimum Value of y
   100;               !- Maximum Value of y

Curve:Quadratic,
   <%= system_name %> HP_Heat-PLF-fPLR2,   !- Name
   <%= 1 - heating_coil_cd %>,<%= heating_coil_cd %>,0,     !- Coefficients (List)
   0,                   !- Minimum Value of x
   1,                   !- Maximum Value of x
   0.7,                 !- Minimum Value of y
   1;                   !- Maximum Value of y

Curve:Quadratic,
   <%= system_name %> HP_Heat-Cap-fFF2,                     !- Name
   0.76634609,0.32840943,-0.094701495,   !- Coefficients (List)
   0,                                    !- Minimum Value of x
   2,                                    !- Maximum Value of x
   0,                                    !- Minimum Value of y
   2;                                    !- Maximum Value of y

Curve:Quadratic,
   <%= system_name %> HP_Heat-EIR-fFF2,                      !- Name
   2.001041353,-1.58869128,0.587593517,   !- Coefficients (List)
   0,                                     !- Minimum Value of x
   2,                                     !- Maximum Value of x
   0,                                     !- Minimum Value of y
   2;                                     !- Maximum Value of y
    <% elsif comp_speeds > 2 %>
      <% if ashp_type == "UNITARY" %>
! Following performance curves taken from four-speed ASHP system in BeOpt

Curve:Biquadratic,
   <%= system_name %> HP_Heat-Cap-fT1,   !- Name
   0.8933210315759998,-0.00973374264,0.000063643968,0.0391130520048,-0.00000250816824,-0.000272588652,   !- Coefficients (list)
   -100,              !- Minimum Value of x
   100,               !- Maximum Value of x
   -100,              !- Minimum Value of y
   100;               !- Maximum Value of y

Curve:Biquadratic,
   <%= system_name %> HP_Heat-EIR-fT1,   !- Name
   0.4666484870000001,0.020263329,0.00126839196,-0.0170161326,0.00317499588,-0.00349609608,   !- Coefficients (List)
   -100,              !- Minimum Value of x
   100,               !- Maximum Value of x
   -100,              !- Minimum Value of y
   100;               !- Maximum Value of y

Curve:Quadratic,
   <%= system_name %> HP_Heat-PLF-fPLR1,   !- Name
   <%= 1 - heating_coil_cd %>,<%= heating_coil_cd %>,0,     !- Coefficients (List)
   0,                   !- Minimum Value of x
   1,                   !- Maximum Value of x
   0.7,                 !- Minimum Value of y
   1;                   !- Maximum Value of y

Curve:Quadratic,
   <%= system_name %> HP_Heat-Cap-fFF1,   !- Name
   1,0,0,              !- Coefficients (List)
   0,                  !- Minimum Value of x
   2,                  !- Maximum Value of x
   0,                  !- Minimum Value of y
   2;                  !- Maximum Value of y

Curve:Quadratic,
   <%= system_name %> HP_Heat-EIR-fFF1,   !- Name
   1,0,0,              !- Coefficients (List)
   0,                  !- Minimum Value of x
   2,                  !- Maximum Value of x
   0,                  !- Minimum Value of y
   2;                  !- Maximum Value of y

Curve:Biquadratic,
   <%= system_name %> HP_Heat-Cap-fT2,   !- Name
   0.9237345336,-0.00597077568,0,0.02781672876,0.000065916828,-0.000189254232,   !- Coefficients (list)
   -100,              !- Minimum Value of x
   100,               !- Maximum Value of x
   -100,              !- Minimum Value of y
   100;               !- Maximum Value of y

Curve:Biquadratic,
   <%= system_name %> HP_Heat-EIR-fT2,   !- Name
   0.450656859,0.0292902642,0.00039314484,-0.0097895178,0.00053936928,-0.0011808828,   !- Coefficients (List)
   -100,              !- Minimum Value of x
   100,               !- Maximum Value of x
   -100,              !- Minimum Value of y
   100;               !- Maximum Value of y

Curve:Quadratic,
   <%= system_name %> HP_Heat-PLF-fPLR2,   !- Name
   <%= 1 - heating_coil_cd %>,<%= heating_coil_cd %>,0,     !- Coefficients (List)
   0,                   !- Minimum Value of x
   1,                   !- Maximum Value of x
   0.7,                 !- Minimum Value of y
   1;                   !- Maximum Value of y

Curve:Quadratic,
   <%= system_name %> HP_Heat-Cap-fFF2,   !- Name
   1,0,0,              !- Coefficients (List)
   0,                  !- Minimum Value of x
   2,                  !- Maximum Value of x
   0,                  !- Minimum Value of y
   2;                  !- Maximum Value of y

Curve:Quadratic,
   <%= system_name %> HP_Heat-EIR-fFF2,   !- Name
   1,0,0,              !- Coefficients (List)
   0,                  !- Minimum Value of x
   2,                  !- Maximum Value of x
   0,                  !- Minimum Value of y
   2;                  !- Maximum Value of y

Curve:Biquadratic,
   <%= system_name %> HP_Heat-Cap-fT3,   !- Name
   0.9620542196000001,-0.00949277772,0.000109212948,0.0247078314,0.000034225092,-0.000125697744,   !- Coefficients (list)
   -100,              !- Minimum Value of x
   100,               !- Maximum Value of x
   -100,              !- Minimum Value of y
   100;               !- Maximum Value of y

Curve:Biquadratic,
   <%= system_name %> HP_Heat-EIR-fT3,   !- Name
   0.5725180114,0.02289624912,0.000266018904,-0.0106675434,0.00049092156,-0.00068136876,   !- Coefficients (List)
   -100,              !- Minimum Value of x
   100,               !- Maximum Value of x
   -100,              !- Minimum Value of y
   100;               !- Maximum Value of y

Curve:Quadratic,
   <%= system_name %> HP_Heat-PLF-fPLR3,   !- Name
   <%= 1 - heating_coil_cd %>,<%= heating_coil_cd %>,0,     !- Coefficients (List)
   0,                   !- Minimum Value of x
   1,                   !- Maximum Value of x
   0.7,                 !- Minimum Value of y
   1;                   !- Maximum Value of y

Curve:Quadratic,
   <%= system_name %> HP_Heat-Cap-fFF3,   !- Name
   1,0,0,              !- Coefficients (List)
   0,                  !- Minimum Value of x
   2,                  !- Maximum Value of x
   0,                  !- Minimum Value of y
   2;                  !- Maximum Value of y

Curve:Quadratic,
   <%= system_name %> HP_Heat-EIR-fFF3,   !- Name
   1,0,0,              !- Coefficients (List)
   0,                  !- Minimum Value of x
   2,                  !- Maximum Value of x
   0,                  !- Minimum Value of y
   2;                  !- Maximum Value of y

Curve:Biquadratic,
   <%= system_name %> HP_Heat-Cap-fT4,   !- Name
   0.93607915412,-0.005481563544,-0.0000085897908,0.02491053192,0.000053087076,-0.000155750364,   !- Coefficients (list)
   -100,              !- Minimum Value of x
   100,               !- Maximum Value of x
   -100,              !- Minimum Value of y
   100;               !- Maximum Value of y

Curve:Biquadratic,
   <%= system_name %> HP_Heat-EIR-fT4,   !- Name
   0.668195855,0.0146719548,0.00044596332,-0.0114392286,0.00049710348,-0.00069095592,   !- Coefficients (List)
   -100,              !- Minimum Value of x
   100,               !- Maximum Value of x
   -100,              !- Minimum Value of y
   100;               !- Maximum Value of y

Curve:Quadratic,
   <%= system_name %> HP_Heat-PLF-fPLR4,   !- Name
   <%= 1 - heating_coil_cd %>,<%= heating_coil_cd %>,0,     !- Coefficients (List)
   0,                   !- Minimum Value of x
   1,                   !- Maximum Value of x
   0.7,                 !- Minimum Value of y
   1;                   !- Maximum Value of y

Curve:Quadratic,
   <%= system_name %> HP_Heat-Cap-fFF4,   !- Name
   1,0,0,              !- Coefficients (List)
   0,                  !- Minimum Value of x
   2,                  !- Maximum Value of x
   0,                  !- Minimum Value of y
   2;                  !- Maximum Value of y

Curve:Quadratic,
   <%= system_name %> HP_Heat-EIR-fFF4,   !- Name
   1,0,0,              !- Coefficients (List)
   0,                  !- Minimum Value of x
   2,                  !- Maximum Value of x
   0,                  !- Minimum Value of y
   2;                  !- Maximum Value of y

      <% elsif ashp_type == "MINISPLIT" %>
! Following performance curves taken from four-speed Minisplit Heat Pump system in BeOpt (based on Fujitsu 12RLS minisplit unit testing in NREL report at http://www.nrel.gov/docs/fy11osti/52175.pdf)

Curve:Biquadratic,
   <%= system_name %> HP_Heat-Cap-fT1,   !- Name
   1.1527124655908572,-0.010386676170938,0,0.011263752411403,-0.000392549621117,0,   !- Coefficients (list)
   -100,              !- Minimum Value of x
   100,               !- Maximum Value of x
   -100,              !- Minimum Value of y
   100;               !- Maximum Value of y

Curve:Biquadratic,
   <%= system_name %> HP_Heat-EIR-fT1,   !- Name
   0.966475472847719,0.005914950101249,0.000191201688297,-0.012965668198361,0.000042253229429,-0.000524002558712,   !- Coefficients (list)
   -100,              !- Minimum Value of x
   100,               !- Maximum Value of x
   -100,              !- Minimum Value of y
   100;               !- Maximum Value of y

Curve:Quadratic,
   <%= system_name %> HP_Heat-PLF-fPLR1,   !- Name
   <%= 1 - heating_coil_cd %>,<%= heating_coil_cd %>,0,     !- Coefficients (List)
   0,                   !- Minimum Value of x
   1,                   !- Maximum Value of x
   0.7,                 !- Minimum Value of y
   1;                   !- Maximum Value of y

Curve:Quadratic,
   <%= system_name %> HP_Heat-Cap-fFF1,   !- Name
   1,0,0,              !- Coefficients (List)
   0,                  !- Minimum Value of x
   2,                  !- Maximum Value of x
   0,                  !- Minimum Value of y
   2;                  !- Maximum Value of y

Curve:Quadratic,
   <%= system_name %> HP_Heat-EIR-fFF1,   !- Name
   1,0,0,              !- Coefficients (List)
   0,                  !- Minimum Value of x
   2,                  !- Maximum Value of x
   0,                  !- Minimum Value of y
   2;                  !- Maximum Value of y

Curve:Biquadratic,
   <%= system_name %> HP_Heat-Cap-fT2,   !- Name
   1.1527124655908572,-0.010386676170938,0,0.011263752411403,-0.000392549621117,0,   !- Coefficients (list)
   -100,              !- Minimum Value of x
   100,               !- Maximum Value of x
   -100,              !- Minimum Value of y
   100;               !- Maximum Value of y

Curve:Biquadratic,
   <%= system_name %> HP_Heat-EIR-fT2,   !- Name
   0.966475472847719,0.005914950101249,0.000191201688297,-0.012965668198361,0.000042253229429,-0.000524002558712,   !- Coefficients (list)
   -100,              !- Minimum Value of x
   100,               !- Maximum Value of x
   -100,              !- Minimum Value of y
   100;               !- Maximum Value of y

Curve:Quadratic,
   <%= system_name %> HP_Heat-PLF-fPLR2,   !- Name
   <%= 1 - heating_coil_cd %>,<%= heating_coil_cd %>,0,     !- Coefficients (List)
   0,                   !- Minimum Value of x
   1,                   !- Maximum Value of x
   0.7,                 !- Minimum Value of y
   1;                   !- Maximum Value of y

Curve:Quadratic,
   <%= system_name %> HP_Heat-Cap-fFF2,   !- Name
   1,0,0,              !- Coefficients (List)
   0,                  !- Minimum Value of x
   2,                  !- Maximum Value of x
   0,                  !- Minimum Value of y
   2;                  !- Maximum Value of y

Curve:Quadratic,
   <%= system_name %> HP_Heat-EIR-fFF2,   !- Name
   1,0,0,              !- Coefficients (List)
   0,                  !- Minimum Value of x
   2,                  !- Maximum Value of x
   0,                  !- Minimum Value of y
   2;                  !- Maximum Value of y

Curve:Biquadratic,
   <%= system_name %> HP_Heat-Cap-fT3,   !- Name
   1.1527124655908572,-0.010386676170938,0,0.011263752411403,-0.000392549621117,0,   !- Coefficients (list)
   -100,              !- Minimum Value of x
   100,               !- Maximum Value of x
   -100,              !- Minimum Value of y
   100;               !- Maximum Value of y

Curve:Biquadratic,
   <%= system_name %> HP_Heat-EIR-fT3,   !- Name
   0.966475472847719,0.005914950101249,0.000191201688297,-0.012965668198361,0.000042253229429,-0.000524002558712,   !- Coefficients (list)
   -100,              !- Minimum Value of x
   100,               !- Maximum Value of x
   -100,              !- Minimum Value of y
   100;               !- Maximum Value of y

Curve:Quadratic,
   <%= system_name %> HP_Heat-PLF-fPLR3,   !- Name
   <%= 1 - heating_coil_cd %>,<%= heating_coil_cd %>,0,     !- Coefficients (List)
   0,                   !- Minimum Value of x
   1,                   !- Maximum Value of x
   0.7,                 !- Minimum Value of y
   1;                   !- Maximum Value of y

Curve:Quadratic,
   <%= system_name %> HP_Heat-Cap-fFF3,   !- Name
   1,0,0,              !- Coefficients (List)
   0,                  !- Minimum Value of x
   2,                  !- Maximum Value of x
   0,                  !- Minimum Value of y
   2;                  !- Maximum Value of y

Curve:Quadratic,
   <%= system_name %> HP_Heat-EIR-fFF3,   !- Name
   1,0,0,              !- Coefficients (List)
   0,                  !- Minimum Value of x
   2,                  !- Maximum Value of x
   0,                  !- Minimum Value of y
   2;                  !- Maximum Value of y

Curve:Biquadratic,
   <%= system_name %> HP_Heat-Cap-fT4,   !- Name
   1.1527124655908572,-0.010386676170938,0,0.011263752411403,-0.000392549621117,0,   !- Coefficients (list)
   -100,              !- Minimum Value of x
   100,               !- Maximum Value of x
   -100,              !- Minimum Value of y
   100;               !- Maximum Value of y

Curve:Biquadratic,
   <%= system_name %> HP_Heat-EIR-fT4,   !- Name
   0.966475472847719,0.005914950101249,0.000191201688297,-0.012965668198361,0.000042253229429,-0.000524002558712,   !- Coefficients (list)
   -100,              !- Minimum Value of x
   100,               !- Maximum Value of x
   -100,              !- Minimum Value of y
   100;               !- Maximum Value of y

Curve:Quadratic,
   <%= system_name %> HP_Heat-PLF-fPLR4,   !- Name
   <%= 1 - heating_coil_cd %>,<%= heating_coil_cd %>,0,     !- Coefficients (List)
   0,                   !- Minimum Value of x
   1,                   !- Maximum Value of x
   0.7,                 !- Minimum Value of y
   1;                   !- Maximum Value of y

Curve:Quadratic,
   <%= system_name %> HP_Heat-Cap-fFF4,   !- Name
   1,0,0,              !- Coefficients (List)
   0,                  !- Minimum Value of x
   2,                  !- Maximum Value of x
   0,                  !- Minimum Value of y
   2;                  !- Maximum Value of y

Curve:Quadratic,
   <%= system_name %> HP_Heat-EIR-fFF4,   !- Name
   1,0,0,              !- Coefficients (List)
   0,                  !- Minimum Value of x
   2,                  !- Maximum Value of x
   0,                  !- Minimum Value of y
   2;                  !- Maximum Value of y
      <% end %>
    <% end %>

Curve:Biquadratic,
  <%= system_name %> DefrostEIR,         !- Name
  0.1528,0,0,0,0,0,   !- Coefficients (List)
  -100,               !- Minimum Value of x
  100,                !- Maximum Value of x
  -100,               !- Minimum Value of y
  100;                !- Maximum Value of y

Curve:Biquadratic,
  <%= system_name %> HP_Heat-Waste,         !- Name
  1,0,0,0,0,0,   !- Coefficients (List)
  -100,               !- Minimum Value of x
  100,                !- Maximum Value of x
  -100,               !- Minimum Value of y
  100;                !- Maximum Value of y
  <% end %>

<% elsif (heating_coil_type == "WSHP") %>

Coil:Heating:WaterToAirHeatPump:EquationFit,
  <%= system_name %> Heating Coil,  !- Name
  <%= system_name %> Water Source Intermediate Node,  !- Water Inlet Node Name
  <%= system_name %> Water Source Outlet Node,  !- Water Outlet Node Name
  <%= heating_coil_inlet_node %>, !- Air Inlet Node Name
  <%= system_name %> Heating Coil Outlet Node,  !- Air Outlet Node Name
  Autosize,                !- Rated Air Flow Rate {m3/s}
  Autosize,                !- Rated Water Flow Rate {m3/s}
  Autosize,                !- Gross Rated Heating Capacity {W}
  <%= heating_coil_eff %>,  !- Rated COP
  -5.215438793,                                      !- Heating Capacity Coefficient 1
  -1.0739883960000003,                               !- Heating Capacity Coefficient 2
  7.597313856,                                       !- Heating Capacity Coefficient 3
  0,                                                 !- Heating Capacity Coefficient 4
  0,                                                 !- Heating Capacity Coefficient 5
  -11.077826657,                                     !- Heating Power Consumption Coefficient 1
  10.233784872000001,                                !- Heating Power Consumption Coefficient 2
  1.529330868,                                       !- Heating Power Consumption Coefficient 3
  0,                                                 !- Heating Power Consumption Coefficient 4
  0;                                                 !- Heating Power Consumption Coefficient 5

Branch,
  <%= system_name %> GHX Demand Branch,  !- Name
  ,                        !- Pressure Drop Curve Name
  Coil:Cooling:WaterToAirHeatPump:EquationFit,    !- Component 1 Object Type
  <%= system_name %> Cooling Coil,   !- Component 1 Name
  <%= system_name %> Water Source Inlet Node,  !- Component 1 Inlet Node Name
  <%= system_name %> Water Source Intermediate Node,  !- Component 1 Outlet Node Name
  Coil:Heating:WaterToAirHeatPump:EquationFit,    !- Component 2 Object Type
  <%= system_name %> Heating Coil,   !- Component 2 Name
  <%= system_name %> Water Source Intermediate Node,  !- Component 2 Inlet Node Name
  <%= system_name %> Water Source Outlet Node;  !- Component 2 Outlet Node Name

<% elsif (heating_coil_type == "NONE") %>

Coil:Heating:Electric,
  <%= system_name %> Heating Coil,  !- Name
  <%= system_name %> Always Off Schedule,  !- Availability Schedule Name
  1,                       !- Efficiency
  0.001,                   !- Nominal Capacity {W}
  <%= heating_coil_inlet_node %>, !- Air Inlet Node Name
  <%= system_name %> Supply Equipment Outlet Node;  !- Air Outlet Node Name

<% end %>

<% if (heating_coil_type == "ASHP" or heating_coil_type == "WSHP") %>
  <% if (hp_supp_heat_coil_type == "ELECTRIC") %>

Coil:Heating:Electric,
  <%= system_name %> Supp Heating Coil,  !- Name
  <%= system_name %> Operation Schedule,  !- Availability Schedule Name
  <%= hp_supp_heat_coil_eff %>,  !- Efficiency
  <%= heating_coil_cap %>,  !- Nominal Capacity
  <%= system_name %> Heating Coil Outlet Node,  !- Air Inlet Node Name
  <%= system_name %> Supply Equipment Outlet Node;  !- Air Outlet Node Name

  <% elsif (hp_supp_heat_coil_type == "GAS") %>

Coil:Heating:Fuel,
  <%= system_name %> Supp Heating Coil,  !- Name
  <%= system_name %> Operation Schedule,  !- Availability Schedule Name
  NaturalGas,               !- Fuel Type
  <%= hp_supp_heat_coil_eff %>,  !- Gas Burner Efficiency
  <%= heating_coil_cap %>, !- Nominal Capacity {W}
  <%= system_name %> Heating Coil Outlet Node,  !- Air Inlet Node Name
  <%= system_name %> Supply Equipment Outlet Node;  !- Air Outlet Node Name

  <% else %>

Coil:Heating:Electric,
  <%= system_name %> Supp Heating Coil,  !- Name
  <%= system_name %> Always Off Schedule,  !- Availability Schedule Name
  1,                        !- Efficiency
  1,                        !- Nominal Capacity
  <%= system_name %> Heating Coil Outlet Node,  !- Air Inlet Node Name
  <%= system_name %> Supply Equipment Outlet Node;  !- Air Outlet Node Name

  <% end %>
<% end %>

<% if (cooling_coil_type == "DX" and comp_speeds > 1) %>
  ! Insert dummy heating coil to simulate multispeed AC

Coil:Heating:Gas:MultiStage,
  <%= system_name %> Dummy Heating Coil,  !- Name
  <%= system_name %> Operation Schedule,  !- Availability Schedule Name
  <%= system_name %> Cooling Coil Outlet Node, !- Air Inlet Node Name
  <%= heating_coil_inlet_node %>,  !- Air Outlet Node Name
  <%= heating_coil_inlet_node %>,                        !- Temp Setpoint node name
  <%= system_name %> Dummy Heating Coil PLF Curve,                        !- Part Load Fraction Correlation Curve Name
  0,                        !- Parasitic Gas Load
  2,                       !- Number of Speeds
  0.92,                    !- Speed 1 Gas burner Efficiency
  Autosize,                !- Speed 1 Nominal Capacity {W}
  0,                        !- Stage 1 Parasitic Electric Load {W}
  0.88,                    !- Speed 2 Gas burner Efficiency
  Autosize,                !- Speed 2 Nominal Capacity {W}
  0;                        !- Stage 2 Parasitic Electric Load {W}

Curve:Quadratic,
  <%= system_name %> Dummy Heating Coil PLF Curve,   !- Name
  1.0,0.0,0,         !- Coefficients (List)
  -100,             !- Minimum Value of x
  100,              !- Maximum Value of x
  -100,             !- Minimum Value of y
  100;              !- Maximum Value of y

<% end %>

AirLoopHVAC:SupplyPath,
  <%= system_name %>,             !- Name
  <%= system_name %> Zone Equipment Inlet Node,  !- Supply Air Path Inlet Node Name
  AirLoopHVAC:ZoneSplitter,  !- Component 1 Object Type
  <%= system_name %> Supply Air Splitter;  !- Component 1 Name

AirLoopHVAC:ZoneSplitter,
  <%= system_name %> Supply Air Splitter,  !- Name
  <%= system_name %> Zone Equipment Inlet Node,  !- Inlet Node Name
<% for zone_name in zone_names[0..-2] %>
  <%= zone_name %> ATU Inlet Node,  !- Outlet Node Name
<% end %>
  <%= zone_names[-1] %> ATU Inlet Node;  !- Outlet Node Name

AirLoopHVAC:ReturnPath,
  <%= system_name %> Return Air Path,    !- Name
  <%= system_name %> Zone Equipment Outlet Node,  !- Return Air Path Outlet Node Name
<% if (return_plenum_zone_name) %>
  AirLoopHVAC:ReturnPlenum,   !- Component 1 Object Type
  <%= system_name %> Return Plenum;   !- Component 1 Name
<% else %>
  AirLoopHVAC:ZoneMixer,   !- Component 1 Object Type
  <%= system_name %> Return Air Mixer;   !- Component 1 Name
<% end %>

<% if (return_plenum_zone_name) %>
AirLoopHVAC:ReturnPlenum,
  <%= system_name %> Return Plenum, ! Name
  <%= return_plenum_zone_name %>, ! Zone Name
  <%= return_plenum_zone_name %> Node, ! Zone Node Name
  <%= system_name %> Zone Equipment Outlet Node,  !- Outlet Node Name
  , !- Induced Air Outlet Node or NodeList Name
<% for zone_name in zone_names[0..-2] %>
  <%= zone_name %> Return Node,  !- Inlet Node Name
<% end %>
  <%= zone_names[-1] %> Return Node;  !- Inlet Node Name

<% else %>
AirLoopHVAC:ZoneMixer,
  <%= system_name %> Return Air Mixer,   !- Name
  <%= system_name %> Zone Equipment Outlet Node,  !- Outlet Node Name
<% for zone_name in zone_names[0..-2] %>
  <%= zone_name %> Return Node,  !- Inlet Node Name
<% end %>
  <%= zone_names[-1] %> Return Node;  !- Inlet Node Name
<% end %>

<% if (use_dummy_return_plenum) %>
! Dummy return plenum zone

Construction,
  <%= system_name %> Plenum Construction,  ! - Name
  Wall Cavity Effective Insulation,  !- Outside Layer
  <%= system_name %> Plenum Material;  ! - Layer 2

Material,
  <%= system_name %> Plenum Material,  !- Name
  Smooth,                  !- Roughness
  0.05,                    !- Thickness {m}
  0.1,                    !- Conductivity {W/m-K}
  200,                     !- Density {kg/m3}
  1000;                    !- Specific Heat {J/kg-K}

Zone,
  <%= return_plenum_zone_name %>,  !- Name
  0,                       !- Direction of Relative North {deg}
  0,                       !- X Origin {m}
  0,                       !- Y Origin {m}
  0,                       !- Z Origin {m}
  ,                        !- Type
  1,                       !- Multiplier
  ,                        !- Ceiling Height {m}
  1.0,                     !- Volume {m3}
  ,                        !- Floor Area {m2}
  ,                        !- Zone Inside Convection Algorithm
  ,                        !- Zone Outside Convection Algorithm
  No;                      !- Part of Total Floor Area

BuildingSurface:Detailed,
  <%= system_name %> Dummy Return Plenum Floor,  !- Name
  Floor,                   !- Surface Type
  <%= system_name %> Plenum Construction,  !- Construction Name
  <%= return_plenum_zone_name %>,  !- Zone Name
  Adiabatic,               !- Outside Boundary Condition
  ,                        !- Outside Boundary Condition Object
  NoSun,                   !- Sun Exposure
  NoWind,                  !- Wind Exposure
  0,                       !- View Factor to Ground
  4,                       !- Number of Vertices
  0,                       !- Vertex 1 X-coordinate {m}
  0,                       !- Vertex 1 Y-coordinate {m}
  -10,                     !- Vertex 1 Z-coordinate {m}
  0,                       !- Vertex 2 X-coordinate {m}
  1,                       !- Vertex 2 Y-coordinate {m}
  -10,                     !- Vertex 2 Z-coordinate {m}
  1,                       !- Vertex 3 X-coordinate {m}
  1,                       !- Vertex 3 Y-coordinate {m}
  -10,                     !- Vertex 3 Z-coordinate {m}
  1,                       !- Vertex 4 X-coordinate {m}
  0,                       !- Vertex 4 Y-coordinate {m}
  -10;                     !- Vertex 4 Z-coordinate {m}

BuildingSurface:Detailed,
  <%= system_name %> Dummy Return Plenum Ceiling,  !- Name
  Ceiling,                   !- Surface Type
  <%= system_name %> Plenum Construction,  !- Construction Name
  <%= return_plenum_zone_name %>,  !- Zone Name
  Adiabatic,               !- Outside Boundary Condition
  ,                        !- Outside Boundary Condition Object
  NoSun,                   !- Sun Exposure
  NoWind,                  !- Wind Exposure
  0,                       !- View Factor to Ground
  4,                       !- Number of Vertices
  0,                       !- Vertex 1 X-coordinate {m}
  0,                       !- Vertex 1 Y-coordinate {m}
  -9,                     !- Vertex 1 Z-coordinate {m}
  1,                       !- Vertex 2 X-coordinate {m}
  0,                       !- Vertex 2 Y-coordinate {m}
  -9,                     !- Vertex 2 Z-coordinate {m}
  1,                       !- Vertex 3 X-coordinate {m}
  1,                       !- Vertex 3 Y-coordinate {m}
  -9,                     !- Vertex 3 Z-coordinate {m}
  0,                       !- Vertex 4 X-coordinate {m}
  1,                       !- Vertex 4 Y-coordinate {m}
  -9;                     !- Vertex 4 Z-coordinate {m}

BuildingSurface:Detailed,
  <%= system_name %> Dummy Return Plenum W Wall,  !- Name
  Wall,                   !- Surface Type
  <%= system_name %> Plenum Construction,  !- Construction Name
  <%= return_plenum_zone_name %>,  !- Zone Name
  Adiabatic,               !- Outside Boundary Condition
  ,                        !- Outside Boundary Condition Object
  NoSun,                   !- Sun Exposure
  NoWind,                  !- Wind Exposure
  0,                       !- View Factor to Ground
  4,                       !- Number of Vertices
  0.000000000000,  !- Vertex 1 X-coordinate {m}
  1.000000000000,  !- Vertex 1 Y-coordinate {m}
  -10.000000000000,  !- Vertex 1 Z-coordinate {m}
  0.000000000000,  !- Vertex 2 X-coordinate {m}
  0.000000000000,  !- Vertex 2 Y-coordinate {m}
  -10.000000000000,  !- Vertex 2 Z-coordinate {m}
  0.000000000000,  !- Vertex 3 X-coordinate {m}
  0.000000000000,  !- Vertex 3 Y-coordinate {m}
  -9.000000000000,  !- Vertex 3 Z-coordinate {m}
  0.000000000000,  !- Vertex 4 X-coordinate {m}
  1.000000000000,  !- Vertex 4 Y-coordinate {m}
  -9.000000000000;  !- Vertex 4 Z-coordinate {m}

BuildingSurface:Detailed,
  <%= system_name %> Dummy Return Plenum N Wall,  !- Name
  Wall,                   !- Surface Type
  <%= system_name %> Plenum Construction,  !- Construction Name
  <%= return_plenum_zone_name %>,  !- Zone Name
  Adiabatic,               !- Outside Boundary Condition
  ,                        !- Outside Boundary Condition Object
  NoSun,                   !- Sun Exposure
  NoWind,                  !- Wind Exposure
  0,                       !- View Factor to Ground
  4,                       !- Number of Vertices
  1.000000000000,  !- Vertex 1 X-coordinate {m}
  1.000000000000,  !- Vertex 1 Y-coordinate {m}
  -10.000000000000,  !- Vertex 1 Z-coordinate {m}
  0.000000000000,  !- Vertex 2 X-coordinate {m}
  1.000000000000,  !- Vertex 2 Y-coordinate {m}
  -10.000000000000,  !- Vertex 2 Z-coordinate {m}
  0.000000000000,  !- Vertex 3 X-coordinate {m}
  1.000000000000,  !- Vertex 3 Y-coordinate {m}
  -9.000000000000,  !- Vertex 3 Z-coordinate {m}
  1.000000000000,  !- Vertex 4 X-coordinate {m}
  1.000000000000,  !- Vertex 4 Y-coordinate {m}
  -9.000000000000;  !- Vertex 4 Z-coordinate {m}

BuildingSurface:Detailed,
  <%= system_name %> Dummy Return Plenum E Wall,  !- Name
  Wall,                   !- Surface Type
  <%= system_name %> Plenum Construction,  !- Construction Name
  <%= return_plenum_zone_name %>,  !- Zone Name
  Adiabatic,               !- Outside Boundary Condition
  ,                        !- Outside Boundary Condition Object
  NoSun,                   !- Sun Exposure
  NoWind,                  !- Wind Exposure
  0,                       !- View Factor to Ground
  4,                       !- Number of Vertices
  1.000000000000,  !- Vertex 1 X-coordinate {m}
  0.000000000000,  !- Vertex 1 Y-coordinate {m}
  -10.000000000000,  !- Vertex 1 Z-coordinate {m}
  1.000000000000,  !- Vertex 2 X-coordinate {m}
  1.000000000000,  !- Vertex 2 Y-coordinate {m}
  -10.000000000000,  !- Vertex 2 Z-coordinate {m}
  1.000000000000,  !- Vertex 3 X-coordinate {m}
  1.000000000000,  !- Vertex 3 Y-coordinate {m}
  -9.000000000000,  !- Vertex 3 Z-coordinate {m}
  1.000000000000,  !- Vertex 4 X-coordinate {m}
  0.000000000000,  !- Vertex 4 Y-coordinate {m}
  -9.000000000000;  !- Vertex 4 Z-coordinate {m}

BuildingSurface:Detailed,
  <%= system_name %> Dummy Return Plenum S Wall,  !- Name
  Wall,                   !- Surface Type
  <%= system_name %> Plenum Construction,  !- Construction Name
  <%= return_plenum_zone_name %>,  !- Zone Name
  Adiabatic,               !- Outside Boundary Condition
  ,                        !- Outside Boundary Condition Object
  NoSun,                   !- Sun Exposure
  NoWind,                  !- Wind Exposure
  0,                       !- View Factor to Ground
  4,                       !- Number of Vertices
  0.000000000000,  !- Vertex 1 X-coordinate {m}
  0.000000000000,  !- Vertex 1 Y-coordinate {m}
  -10.000000000000,  !- Vertex 1 Z-coordinate {m}
  1.000000000000,  !- Vertex 2 X-coordinate {m}
  0.000000000000,  !- Vertex 2 Y-coordinate {m}
  -10.000000000000,  !- Vertex 2 Z-coordinate {m}
  1.000000000000,  !- Vertex 3 X-coordinate {m}
  0.000000000000,  !- Vertex 3 Y-coordinate {m}
  -9.000000000000,  !- Vertex 3 Z-coordinate {m}
  0.000000000000,  !- Vertex 4 X-coordinate {m}
  0.000000000000,  !- Vertex 4 Y-coordinate {m}
  -9.000000000000;  !- Vertex 4 Z-coordinate {m}

InternalMass,
  <%= return_plenum_zone_name %> Plenum Internal Mass,  !- Name
  <%= system_name %> Plenum Construction,  !- Construction Name
  <%= return_plenum_zone_name %>,          !- Zone Name
  5.0;      !- Surface Area {m2}

<% end %>
